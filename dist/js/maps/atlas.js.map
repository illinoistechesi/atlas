{"version":3,"sources":["atlas.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","window","Atlas","hotKeys","shiftDown","keyChar","addEventListener","String","fromCharCode","which","toLowerCase","altKey","atlas","init","Promise","resolve","reject","google","maps","event","addDomListener","setMap","map","isShiftClick","markers","addMarker","data","options","opt","name","marker","Marker","position","LatLng","lat","lng","title","entry","ref","push","idx","events","addListener","readOnly","saveMarkers","MAP_TAG","removeMarker","updateIcons","callback","forEach","icon","getIcon","newIcon","setIcon","updateName","vex","dialog","prompt","message","value","placeholder","markersToString","output","coord","markersFromString","str","split","pair","filter","coords","parseFloat","tag","list","localStorage","setItem","loadMarkers","getItem","lastInfoWindow","addDefaultMarker","click","m","console","log","_entry","info","InfoWindow","content","open","close","dblclick","then","updated","path","SymbolPath","CIRCLE","scale","fillColor","fillOpacity","strokeWeight","addViewMarker","entryData","locData","time","infected","addCustomMarker","text","size","color","opacity","loadMapFromData","line","first","setCenter","removeThemeLabels","theme","elType","elementType","stylers","visibility","changeMapStyle","styles","styledMapType","StyledMapType","mapTypes","set","setMapTypeId","getMapStyleByURL","url","getPage","page","$","get","res","style","nextPage","pagination","currentPage","totalPages","recRes","catch","error","jqXHR","textStatus","errorThrown","setHotKey","shortcut"],"mappings":"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","file":"../atlas.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nwindow.Atlas = function () {\n\n    var hotKeys = {};\n    var shiftDown = false;\n    var keyChar = false;\n    window.addEventListener('keydown', function (e) {\n        keyChar = String.fromCharCode(e.which).toLowerCase();\n        //if(e.shiftKey){\n        //if(e.ctrlKey){\n        if (e.altKey) {\n            shiftDown = true;\n            if (hotKeys[keyChar]) {\n                hotKeys[keyChar](e);\n            }\n        }\n    });\n    window.addEventListener('keyup', function (e) {\n        shiftDown = false;\n        keyChar = false;\n    });\n\n    var atlas = {\n\n        init: function init() {\n            return new Promise(function (resolve, reject) {\n                google.maps.event.addDomListener(window, 'load', resolve);\n            });\n        },\n\n        setMap: function setMap(map) {\n            atlas.map = map;\n        },\n\n        isShiftClick: function isShiftClick() {\n            return shiftDown;\n        },\n\n        // Map Markers\n\n        map: false,\n        markers: [],\n\n        addMarker: function addMarker(data, options) {\n            var opt = options || {};\n            if (!data.name) {\n                data.name = 'Location ' + atlas.markers.length;\n            }\n            var marker = new google.maps.Marker({\n                position: new google.maps.LatLng(data.lat, data.lng),\n                map: data.map,\n                title: data.name\n            });\n            var entry = {\n                ref: marker,\n                data: data\n            };\n            atlas.markers.push(entry);\n            var idx = atlas.markers.length - 1;\n\n            var _loop = function _loop(event) {\n                google.maps.event.addListener(marker, event, function (e) {\n                    data.events[event](e, marker, idx);\n                });\n            };\n\n            for (var event in data.events) {\n                _loop(event);\n            }\n            if (!opt.readOnly) {\n                atlas.saveMarkers(window.MAP_TAG, atlas.markers);\n            }\n            return entry;\n        },\n\n        removeMarker: function removeMarker(idx, options) {\n            var opt = options || {};\n            var entry = atlas.markers[idx];\n            if (entry) {\n                entry.ref.setMap(null);\n                atlas.markers[idx] = null;\n                //markers.splice(idx, 1);\n            }\n            if (!opt.readOnly) {\n                atlas.saveMarkers(window.MAP_TAG, atlas.markers);\n            }\n        },\n\n        /*clearMap: (makers) => {\n        \tmarkers.forEach(entry => {\n        \t\tentry.ref.setMap(null);\n        \t});\n        },*/\n\n        updateIcons: function updateIcons(markers, callback) {\n            markers.forEach(function (entry, idx) {\n                var icon = entry.ref.getIcon();\n                var newIcon = callback(icon, entry, idx);\n                entry.ref.setIcon(newIcon);\n            });\n        },\n\n        updateName: function updateName(idx) {\n            return new Promise(function (resolve, reject) {\n                var entry = atlas.markers[idx];\n                var vx = vex.dialog.prompt({\n                    message: 'Update Marker Name',\n                    value: entry.data.name,\n                    placeholder: 'Location ' + idx,\n                    callback: function callback(value) {\n                        if (value) {\n                            entry.data.name = value;\n                            atlas.saveMarkers(window.MAP_TAG, atlas.markers);\n                            resolve(true);\n                        } else {\n                            resolve(false);\n                        }\n                    }\n                });\n            });\n        },\n\n        markersToString: function markersToString(markers) {\n            var output = '';\n            markers.forEach(function (entry, idx) {\n                if (entry !== null) {\n                    var coord = entry.ref.position;\n                    var name = entry.data.name || 'Location ' + idx;\n                    output += coord.lat() + ',' + coord.lng() + ',' + name + '$';\n                }\n            });\n            return output;\n        },\n\n        markersFromString: function markersFromString(str) {\n            return str.split('$').map(function (pair) {\n                var coords = pair.split(',');\n                return coords;\n            }).filter(function (coords) {\n                return coords.length !== 1;\n            }).map(function (coords, idx) {\n                return {\n                    lat: parseFloat(coords[0]),\n                    lng: parseFloat(coords[1]),\n                    name: coords[2] || 'Location ' + idx\n                };\n            });\n        },\n\n        saveMarkers: function saveMarkers(tag, list) {\n            if (tag) {\n                localStorage.setItem(tag, atlas.markersToString(list));\n            }\n        },\n\n        loadMarkers: function loadMarkers(tag) {\n            var str = localStorage.getItem(tag);\n            return str ? atlas.markersFromString(str) : false;\n        },\n\n        lastInfoWindow: false,\n\n        addDefaultMarker: function addDefaultMarker(data) {\n            var entry = atlas.addMarker({\n                map: data.map,\n                name: data.name,\n                lat: data.coord.lat,\n                lng: data.coord.lng,\n                events: {\n                    click: function click(e, m, i) {\n                        console.log('click', i);\n                        if (atlas.isShiftClick()) {\n                            atlas.removeMarker(i);\n                        } else {\n                            var _entry = atlas.markers[i];\n                            var info = new google.maps.InfoWindow({\n                                content: _entry.data.name\n                            });\n                            if (atlas.map) {\n                                info.open(atlas.map, _entry.ref);\n                                if (atlas.lastInfoWindow) {\n                                    atlas.lastInfoWindow.close();\n                                    atlas.lastInfoWindow = false;\n                                }\n                                atlas.lastInfoWindow = info;\n                            }\n                        }\n                    },\n                    dblclick: function dblclick(e, m, i) {\n                        console.log('dblclick', i);\n                        atlas.updateName(i).then(function (updated) {\n                            if (updated) {\n                                if (atlas.lastInfoWindow) {\n                                    atlas.lastInfoWindow.close();\n                                    atlas.lastInfoWindow = false;\n                                }\n                            }\n                        });\n                    }\n                }\n            });\n            entry.ref.setIcon({\n                path: google.maps.SymbolPath.CIRCLE,\n                scale: 7.5,\n                fillColor: '#F00',\n                fillOpacity: 0.5,\n                strokeWeight: 0\n            });\n            return entry;\n        },\n\n        addViewMarker: function addViewMarker(data) {\n            var entry = atlas.addMarker({\n                map: data.map,\n                lat: data.coord.lat,\n                lng: data.coord.lng,\n                events: {\n                    click: function click(e, m, i) {\n                        console.log('click', i, data);\n                        var entry = atlas.markers[i];\n                        var entryData = entry.data;\n                        var locName = entryData.name || 'Location ' + i;\n                        var locData = '\\n                            <h3>' + locName + '</h3>\\n                            <ul>\\n                                <li>Time: ' + entryData.time + '</li>\\n                                <li>Infected: ' + entryData.infected + '</li>\\n                            </ul>\\n                        ';\n                        var info = new google.maps.InfoWindow({\n                            content: locData\n                        });\n                        if (atlas.map) {\n                            info.open(atlas.map, entry.ref);\n                            if (atlas.lastInfoWindow) {\n                                atlas.lastInfoWindow.close();\n                                atlas.lastInfoWindow = false;\n                            }\n                            atlas.lastInfoWindow = info;\n                        }\n                    }\n                }\n            }, {\n                readOnly: true\n            });\n            var icon = data.icon || {\n                scale: 0\n            };\n            entry.ref.setIcon({\n                path: google.maps.SymbolPath.CIRCLE,\n                scale: 1.0 + 9.0 * icon.scale,\n                fillColor: '#F00',\n                fillOpacity: 0.5,\n                strokeWeight: 0\n            });\n            return entry;\n        },\n\n        addCustomMarker: function addCustomMarker(data) {\n            var entry = atlas.addMarker({\n                map: data.map,\n                lat: data.coord.lat,\n                lng: data.coord.lng,\n                events: {\n                    click: function click(e, m, i) {\n                        console.log('click', i, data);\n                        var entry = atlas.markers[i];\n                        var info = new google.maps.InfoWindow({\n                            content: data.text\n                        });\n                        if (atlas.map) {\n                            info.open(atlas.map, entry.ref);\n                            if (atlas.lastInfoWindow) {\n                                atlas.lastInfoWindow.close();\n                                atlas.lastInfoWindow = false;\n                            }\n                            atlas.lastInfoWindow = info;\n                        }\n                    }\n                }\n            }, {\n                readOnly: true\n            });\n            var icon = data.icon || {\n                size: 0,\n                color: 'rgb(0,0,0)',\n                opacity: 1.0\n            };\n            entry.ref.setIcon({\n                path: google.maps.SymbolPath.CIRCLE,\n                scale: icon.size,\n                fillColor: icon.color,\n                fillOpacity: icon.opacity,\n                strokeWeight: 0\n            });\n            return entry;\n        },\n\n        loadMapFromData: function loadMapFromData(map, value) {\n            var input = value.split('$@@$').map(function (line) {\n                return line.split('$@$');\n            });\n            input.forEach(function (data) {\n                var lat = parseFloat(data[0]);\n                var lng = parseFloat(data[1]);\n                var color = data[2];\n                var size = parseFloat(data[3]);\n                var opacity = parseFloat(data[4]);\n                var text = data[5];\n                atlas.addCustomMarker({\n                    map: map,\n                    coord: {\n                        lat: lat,\n                        lng: lng\n                    },\n                    icon: {\n                        size: size,\n                        color: color,\n                        opacity: opacity\n                    },\n                    text: text\n                });\n            });\n            var first = atlas.markers[0];\n            if (first) {\n                map.setCenter({\n                    lat: first.data.lat,\n                    lng: first.data.lng\n                });\n            }\n        },\n\n        // Map Themes\n\n        removeThemeLabels: function removeThemeLabels(theme) {\n            var elementTypes = ['labels', 'labels.text.fill', 'labels.text.stroke'];\n            elementTypes.forEach(function (elType) {\n                theme.push({\n                    elementType: 'labels',\n                    stylers: [{\n                        visibility: 'off'\n                    }]\n                });\n            });\n            return theme;\n        },\n\n        changeMapStyle: function changeMapStyle(map, name, styles) {\n            var theme = atlas.removeThemeLabels(styles);\n            var styledMapType = new google.maps.StyledMapType(theme, {\n                map: map,\n                name: name\n            });\n            map.mapTypes.set(name, styledMapType);\n            map.setMapTypeId(name);\n        },\n\n        getMapStyleByURL: function getMapStyleByURL(url) {\n            var SNAZZY_MAPS_URL = 'https://snazzymaps.com/explore.json?key=6fbb0a74-ec67-4329-83ee-15edd4740c4b';\n\n            var getPage = function getPage(page) {\n                return new Promise(function (resolve, reject) {\n                    $.get(SNAZZY_MAPS_URL, {\n                        page: page\n                    }, function (res) {\n                        res.styles.forEach(function (style) {\n                            if (style.url === url) {\n                                resolve(style);\n                            }\n                        });\n                        var nextPage = res.pagination.currentPage + 1;\n                        if (nextPage > res.pagination.totalPages) {\n                            reject('Could not find style.');\n                        } else {\n                            getPage(nextPage).then(function (recRes) {\n                                resolve(recRes);\n                            }).catch(reject);\n                        }\n                    }).error(function (jqXHR, textStatus, errorThrown) {\n                        reject(errorThrown);\n                    });\n                });\n            };\n\n            return getPage(1);\n        },\n\n        setHotKey: function setHotKey(shortcut, callback) {\n            hotKeys[shortcut] = callback;\n        }\n    };\n\n    return atlas;\n};\n\n},{}]},{},[1])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvYXRsYXMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0FBLE9BQU8sS0FBUCxHQUFlLFlBQU07O0FBRWpCLFFBQUksVUFBVSxFQUFkO0FBQ0EsUUFBSSxZQUFZLEtBQWhCO0FBQ0EsUUFBSSxVQUFVLEtBQWQ7QUFDQSxXQUFPLGdCQUFQLENBQXdCLFNBQXhCLEVBQW1DLGFBQUs7QUFDcEMsa0JBQVUsT0FBTyxZQUFQLENBQW9CLEVBQUUsS0FBdEIsRUFBNkIsV0FBN0IsRUFBVjtBQUNBO0FBQ0E7QUFDQSxZQUFHLEVBQUUsTUFBTCxFQUFZO0FBQ1Isd0JBQVksSUFBWjtBQUNBLGdCQUFHLFFBQVEsT0FBUixDQUFILEVBQW9CO0FBQ2hCLHdCQUFRLE9BQVIsRUFBaUIsQ0FBakI7QUFDSDtBQUNKO0FBQ0osS0FWRDtBQVdBLFdBQU8sZ0JBQVAsQ0FBd0IsT0FBeEIsRUFBaUMsYUFBSztBQUNsQyxvQkFBWSxLQUFaO0FBQ0Esa0JBQVUsS0FBVjtBQUNILEtBSEQ7O0FBS0gsUUFBSSxRQUFROztBQUVYLGNBQU0sZ0JBQU07QUFDWCxtQkFBTyxJQUFJLE9BQUosQ0FBWSxVQUFDLE9BQUQsRUFBVSxNQUFWLEVBQXFCO0FBQ3ZDLHVCQUFPLElBQVAsQ0FBWSxLQUFaLENBQWtCLGNBQWxCLENBQWlDLE1BQWpDLEVBQXlDLE1BQXpDLEVBQWlELE9BQWpEO0FBQ0EsYUFGTSxDQUFQO0FBR0EsU0FOVTs7QUFRTCxnQkFBUSxnQkFBQyxHQUFELEVBQVM7QUFDYixrQkFBTSxHQUFOLEdBQVksR0FBWjtBQUNILFNBVkk7O0FBWUwsc0JBQWMsd0JBQU07QUFDaEIsbUJBQU8sU0FBUDtBQUNILFNBZEk7O0FBZ0JYOztBQUVNLGFBQUssS0FsQkE7QUFtQkwsaUJBQVMsRUFuQko7O0FBcUJMLG1CQUFXLG1CQUFDLElBQUQsRUFBTyxPQUFQLEVBQW1CO0FBQzdCLGdCQUFJLE1BQU0sV0FBVyxFQUFyQjtBQUNHLGdCQUFHLENBQUMsS0FBSyxJQUFULEVBQWM7QUFDVixxQkFBSyxJQUFMLEdBQVksY0FBZSxNQUFNLE9BQU4sQ0FBYyxNQUF6QztBQUNIO0FBQ0osZ0JBQUksU0FBUyxJQUFJLE9BQU8sSUFBUCxDQUFZLE1BQWhCLENBQXVCO0FBQ25DLDBCQUFVLElBQUksT0FBTyxJQUFQLENBQVksTUFBaEIsQ0FBdUIsS0FBSyxHQUE1QixFQUFpQyxLQUFLLEdBQXRDLENBRHlCO0FBRW5DLHFCQUFLLEtBQUssR0FGeUI7QUFHbkMsdUJBQU8sS0FBSztBQUh1QixhQUF2QixDQUFiO0FBS0EsZ0JBQUksUUFBUTtBQUNYLHFCQUFLLE1BRE07QUFFWCxzQkFBTTtBQUZLLGFBQVo7QUFJQSxrQkFBTSxPQUFOLENBQWMsSUFBZCxDQUFtQixLQUFuQjtBQUNBLGdCQUFJLE1BQU0sTUFBTSxPQUFOLENBQWMsTUFBZCxHQUF1QixDQUFqQzs7QUFmNkIsdUNBZ0JyQixLQWhCcUI7QUFpQjVCLHVCQUFPLElBQVAsQ0FBWSxLQUFaLENBQWtCLFdBQWxCLENBQThCLE1BQTlCLEVBQXNDLEtBQXRDLEVBQTZDLGFBQUs7QUFDakQseUJBQUssTUFBTCxDQUFZLEtBQVosRUFBbUIsQ0FBbkIsRUFBc0IsTUFBdEIsRUFBOEIsR0FBOUI7QUFDQSxpQkFGRDtBQWpCNEI7O0FBZ0I3QixpQkFBSSxJQUFJLEtBQVIsSUFBaUIsS0FBSyxNQUF0QixFQUE2QjtBQUFBLHNCQUFyQixLQUFxQjtBQUk1QjtBQUNELGdCQUFHLENBQUMsSUFBSSxRQUFSLEVBQWlCO0FBQ2hCLHNCQUFNLFdBQU4sQ0FBa0IsT0FBTyxPQUF6QixFQUFrQyxNQUFNLE9BQXhDO0FBQ0E7QUFDRCxtQkFBTyxLQUFQO0FBQ0EsU0E5Q0k7O0FBZ0RMLHNCQUFjLHNCQUFDLEdBQUQsRUFBTSxPQUFOLEVBQWtCO0FBQy9CLGdCQUFJLE1BQU0sV0FBVyxFQUFyQjtBQUNBLGdCQUFJLFFBQVEsTUFBTSxPQUFOLENBQWMsR0FBZCxDQUFaO0FBQ0EsZ0JBQUcsS0FBSCxFQUFTO0FBQ1Isc0JBQU0sR0FBTixDQUFVLE1BQVYsQ0FBaUIsSUFBakI7QUFDQSxzQkFBTSxPQUFOLENBQWMsR0FBZCxJQUFxQixJQUFyQjtBQUNBO0FBQ0E7QUFDUCxnQkFBRyxDQUFDLElBQUksUUFBUixFQUFpQjtBQUNWLHNCQUFNLFdBQU4sQ0FBa0IsT0FBTyxPQUF6QixFQUFrQyxNQUFNLE9BQXhDO0FBQ0E7QUFDRCxTQTNESTs7QUE2REw7Ozs7OztBQU1BLHFCQUFhLHFCQUFDLE9BQUQsRUFBVSxRQUFWLEVBQXVCO0FBQ25DLG9CQUFRLE9BQVIsQ0FBZ0IsVUFBQyxLQUFELEVBQVEsR0FBUixFQUFnQjtBQUMvQixvQkFBSSxPQUFPLE1BQU0sR0FBTixDQUFVLE9BQVYsRUFBWDtBQUNBLG9CQUFJLFVBQVUsU0FBUyxJQUFULEVBQWUsS0FBZixFQUFzQixHQUF0QixDQUFkO0FBQ0Esc0JBQU0sR0FBTixDQUFVLE9BQVYsQ0FBa0IsT0FBbEI7QUFDQSxhQUpEO0FBS0EsU0F6RUk7O0FBNEVMLG9CQUFZLG9CQUFDLEdBQUQsRUFBUztBQUNqQixtQkFBTyxJQUFJLE9BQUosQ0FBWSxVQUFDLE9BQUQsRUFBVSxNQUFWLEVBQXFCO0FBQ3BDLG9CQUFJLFFBQVEsTUFBTSxPQUFOLENBQWMsR0FBZCxDQUFaO0FBQ0Esb0JBQUksS0FBSyxJQUFJLE1BQUosQ0FBVyxNQUFYLENBQWtCO0FBQ3ZCLDZCQUFTLG9CQURjO0FBRXZCLDJCQUFPLE1BQU0sSUFBTixDQUFXLElBRks7QUFHdkIsaUNBQWEsY0FBYyxHQUhKO0FBSXZCLDhCQUFVLGtCQUFDLEtBQUQsRUFBVztBQUNqQiw0QkFBRyxLQUFILEVBQVM7QUFDTCxrQ0FBTSxJQUFOLENBQVcsSUFBWCxHQUFrQixLQUFsQjtBQUNBLGtDQUFNLFdBQU4sQ0FBa0IsT0FBTyxPQUF6QixFQUFrQyxNQUFNLE9BQXhDO0FBQ0Esb0NBQVEsSUFBUjtBQUNILHlCQUpELE1BS0k7QUFDQSxvQ0FBUSxLQUFSO0FBQ0g7QUFDSjtBQWJzQixpQkFBbEIsQ0FBVDtBQWVILGFBakJNLENBQVA7QUFrQkgsU0EvRkk7O0FBaUdMLHlCQUFpQix5QkFBQyxPQUFELEVBQWE7QUFDMUIsZ0JBQUksU0FBUyxFQUFiO0FBQ0Esb0JBQVEsT0FBUixDQUFnQixVQUFDLEtBQUQsRUFBUSxHQUFSLEVBQWdCO0FBQzVCLG9CQUFHLFVBQVUsSUFBYixFQUFrQjtBQUNkLHdCQUFJLFFBQVEsTUFBTSxHQUFOLENBQVUsUUFBdEI7QUFDQSx3QkFBSSxPQUFPLE1BQU0sSUFBTixDQUFXLElBQVgsSUFBbUIsY0FBYyxHQUE1QztBQUNBLDhCQUFVLE1BQU0sR0FBTixLQUFjLEdBQWQsR0FBb0IsTUFBTSxHQUFOLEVBQXBCLEdBQWtDLEdBQWxDLEdBQXdDLElBQXhDLEdBQStDLEdBQXpEO0FBQ0g7QUFDSixhQU5EO0FBT0EsbUJBQU8sTUFBUDtBQUNILFNBM0dJOztBQTZHTCwyQkFBbUIsMkJBQUMsR0FBRCxFQUFTO0FBQ3hCLG1CQUFPLElBQUksS0FBSixDQUFVLEdBQVYsRUFBZSxHQUFmLENBQW1CLGdCQUFRO0FBQzlCLG9CQUFJLFNBQVMsS0FBSyxLQUFMLENBQVcsR0FBWCxDQUFiO0FBQ0EsdUJBQU8sTUFBUDtBQUNILGFBSE0sRUFHSixNQUhJLENBR0c7QUFBQSx1QkFBVSxPQUFPLE1BQVAsS0FBa0IsQ0FBNUI7QUFBQSxhQUhILEVBR2tDLEdBSGxDLENBR3NDLFVBQUMsTUFBRCxFQUFTLEdBQVQsRUFBZ0I7QUFDekQsdUJBQU87QUFDSCx5QkFBSyxXQUFXLE9BQU8sQ0FBUCxDQUFYLENBREY7QUFFSCx5QkFBSyxXQUFXLE9BQU8sQ0FBUCxDQUFYLENBRkY7QUFHSCwwQkFBTSxPQUFPLENBQVAsS0FBYSxjQUFjO0FBSDlCLGlCQUFQO0FBS0gsYUFUTSxDQUFQO0FBVUgsU0F4SEk7O0FBMEhMLHFCQUFhLHFCQUFDLEdBQUQsRUFBTSxJQUFOLEVBQWU7QUFDM0IsZ0JBQUcsR0FBSCxFQUFPO0FBQ04sNkJBQWEsT0FBYixDQUFxQixHQUFyQixFQUEwQixNQUFNLGVBQU4sQ0FBc0IsSUFBdEIsQ0FBMUI7QUFDQTtBQUNELFNBOUhJOztBQWdJTCxxQkFBYSxxQkFBQyxHQUFELEVBQVM7QUFDckIsZ0JBQUksTUFBTSxhQUFhLE9BQWIsQ0FBcUIsR0FBckIsQ0FBVjtBQUNBLG1CQUFPLE1BQU0sTUFBTSxpQkFBTixDQUF3QixHQUF4QixDQUFOLEdBQXFDLEtBQTVDO0FBQ0EsU0FuSUk7O0FBcUlMLHdCQUFnQixLQXJJWDs7QUF1SUwsMEJBQWtCLDBCQUFDLElBQUQsRUFBVTtBQUNqQyxnQkFBSSxRQUFRLE1BQU0sU0FBTixDQUFnQjtBQUNyQixxQkFBSyxLQUFLLEdBRFc7QUFFZixzQkFBTSxLQUFLLElBRkk7QUFHckIscUJBQUssS0FBSyxLQUFMLENBQVcsR0FISztBQUlyQixxQkFBSyxLQUFLLEtBQUwsQ0FBVyxHQUpLO0FBS3JCLHdCQUFRO0FBQ1AsMkJBQU8sZUFBQyxDQUFELEVBQUksQ0FBSixFQUFPLENBQVAsRUFBYTtBQUNuQixnQ0FBUSxHQUFSLENBQVksT0FBWixFQUFxQixDQUFyQjtBQUNZLDRCQUFHLE1BQU0sWUFBTixFQUFILEVBQXdCO0FBQ3BCLGtDQUFNLFlBQU4sQ0FBbUIsQ0FBbkI7QUFDSCx5QkFGRCxNQUdJO0FBQ0EsZ0NBQUksU0FBUSxNQUFNLE9BQU4sQ0FBYyxDQUFkLENBQVo7QUFDQSxnQ0FBSSxPQUFPLElBQUksT0FBTyxJQUFQLENBQVksVUFBaEIsQ0FBMkI7QUFDbEMseUNBQVMsT0FBTSxJQUFOLENBQVc7QUFEYyw2QkFBM0IsQ0FBWDtBQUdBLGdDQUFHLE1BQU0sR0FBVCxFQUFhO0FBQ1QscUNBQUssSUFBTCxDQUFVLE1BQU0sR0FBaEIsRUFBcUIsT0FBTSxHQUEzQjtBQUNBLG9DQUFHLE1BQU0sY0FBVCxFQUF3QjtBQUNwQiwwQ0FBTSxjQUFOLENBQXFCLEtBQXJCO0FBQ0EsMENBQU0sY0FBTixHQUF1QixLQUF2QjtBQUNIO0FBQ0Qsc0NBQU0sY0FBTixHQUF1QixJQUF2QjtBQUNIO0FBQ0o7QUFDYixxQkFwQk07QUFxQlAsOEJBQVUsa0JBQUMsQ0FBRCxFQUFJLENBQUosRUFBTyxDQUFQLEVBQWE7QUFDdEIsZ0NBQVEsR0FBUixDQUFZLFVBQVosRUFBd0IsQ0FBeEI7QUFDQSw4QkFBTSxVQUFOLENBQWlCLENBQWpCLEVBQW9CLElBQXBCLENBQXlCLG1CQUFXO0FBQ3BCLGdDQUFHLE9BQUgsRUFBVztBQUNQLG9DQUFHLE1BQU0sY0FBVCxFQUF3QjtBQUNwQiwwQ0FBTSxjQUFOLENBQXFCLEtBQXJCO0FBQ0EsMENBQU0sY0FBTixHQUF1QixLQUF2QjtBQUNIO0FBQ0o7QUFDSix5QkFQYjtBQVFBO0FBL0JNO0FBTGEsYUFBaEIsQ0FBWjtBQXVDUyxrQkFBTSxHQUFOLENBQVUsT0FBVixDQUFrQjtBQUNkLHNCQUFNLE9BQU8sSUFBUCxDQUFZLFVBQVosQ0FBdUIsTUFEZjtBQUVkLHVCQUFPLEdBRk87QUFHZCwyQkFBVyxNQUhHO0FBSWQsNkJBQWEsR0FKQztBQUtkLDhCQUFjO0FBTEEsYUFBbEI7QUFPQSxtQkFBTyxLQUFQO0FBQ0gsU0F2TEk7O0FBeUxMLHVCQUFlLHVCQUFDLElBQUQsRUFBVTtBQUM5QixnQkFBSSxRQUFRLE1BQU0sU0FBTixDQUFnQjtBQUNyQixxQkFBSyxLQUFLLEdBRFc7QUFFckIscUJBQUssS0FBSyxLQUFMLENBQVcsR0FGSztBQUdyQixxQkFBSyxLQUFLLEtBQUwsQ0FBVyxHQUhLO0FBSXJCLHdCQUFRO0FBQ1AsMkJBQU8sZUFBQyxDQUFELEVBQUksQ0FBSixFQUFPLENBQVAsRUFBYTtBQUNuQixnQ0FBUSxHQUFSLENBQVksT0FBWixFQUFxQixDQUFyQixFQUF3QixJQUF4QjtBQUNZLDRCQUFJLFFBQVEsTUFBTSxPQUFOLENBQWMsQ0FBZCxDQUFaO0FBQ0EsNEJBQUksWUFBWSxNQUFNLElBQXRCO0FBQ0EsNEJBQUksVUFBVSxVQUFVLElBQVYsSUFBa0IsY0FBYyxDQUE5QztBQUNBLDRCQUFJLGlEQUNNLE9BRE4sMkZBR2dCLFVBQVUsSUFIMUIsNkRBSW9CLFVBQVUsUUFKOUIsdUVBQUo7QUFPQSw0QkFBSSxPQUFPLElBQUksT0FBTyxJQUFQLENBQVksVUFBaEIsQ0FBMkI7QUFDbEMscUNBQVM7QUFEeUIseUJBQTNCLENBQVg7QUFHQSw0QkFBRyxNQUFNLEdBQVQsRUFBYTtBQUNULGlDQUFLLElBQUwsQ0FBVSxNQUFNLEdBQWhCLEVBQXFCLE1BQU0sR0FBM0I7QUFDQSxnQ0FBRyxNQUFNLGNBQVQsRUFBd0I7QUFDcEIsc0NBQU0sY0FBTixDQUFxQixLQUFyQjtBQUNBLHNDQUFNLGNBQU4sR0FBdUIsS0FBdkI7QUFDSDtBQUNELGtDQUFNLGNBQU4sR0FBdUIsSUFBdkI7QUFDSDtBQUNiO0FBeEJNO0FBSmEsYUFBaEIsRUE4Qkg7QUFDRiwwQkFBVTtBQURSLGFBOUJHLENBQVo7QUFpQ00sZ0JBQUksT0FBTyxLQUFLLElBQUwsSUFBYTtBQUN2Qix1QkFBTztBQURnQixhQUF4QjtBQUdBLGtCQUFNLEdBQU4sQ0FBVSxPQUFWLENBQWtCO0FBQ2pCLHNCQUFNLE9BQU8sSUFBUCxDQUFZLFVBQVosQ0FBdUIsTUFEWjtBQUVqQix1QkFBUSxHQUFELEdBQVMsTUFBTSxLQUFLLEtBRlY7QUFHakIsMkJBQVcsTUFITTtBQUlqQiw2QkFBYSxHQUpJO0FBS2pCLDhCQUFjO0FBTEcsYUFBbEI7QUFPQSxtQkFBTyxLQUFQO0FBQ0EsU0F0T0k7O0FBd09MLHlCQUFpQix5QkFBQyxJQUFELEVBQVU7QUFDdkIsZ0JBQUksUUFBUSxNQUFNLFNBQU4sQ0FBZ0I7QUFDeEIscUJBQUssS0FBSyxHQURjO0FBRXhCLHFCQUFLLEtBQUssS0FBTCxDQUFXLEdBRlE7QUFHeEIscUJBQUssS0FBSyxLQUFMLENBQVcsR0FIUTtBQUl4Qix3QkFBUTtBQUNKLDJCQUFPLGVBQUMsQ0FBRCxFQUFJLENBQUosRUFBTyxDQUFQLEVBQWE7QUFDaEIsZ0NBQVEsR0FBUixDQUFZLE9BQVosRUFBcUIsQ0FBckIsRUFBd0IsSUFBeEI7QUFDQSw0QkFBSSxRQUFRLE1BQU0sT0FBTixDQUFjLENBQWQsQ0FBWjtBQUNBLDRCQUFJLE9BQU8sSUFBSSxPQUFPLElBQVAsQ0FBWSxVQUFoQixDQUEyQjtBQUNsQyxxQ0FBUyxLQUFLO0FBRG9CLHlCQUEzQixDQUFYO0FBR0EsNEJBQUcsTUFBTSxHQUFULEVBQWE7QUFDVCxpQ0FBSyxJQUFMLENBQVUsTUFBTSxHQUFoQixFQUFxQixNQUFNLEdBQTNCO0FBQ0EsZ0NBQUcsTUFBTSxjQUFULEVBQXdCO0FBQ3BCLHNDQUFNLGNBQU4sQ0FBcUIsS0FBckI7QUFDQSxzQ0FBTSxjQUFOLEdBQXVCLEtBQXZCO0FBQ0g7QUFDRCxrQ0FBTSxjQUFOLEdBQXVCLElBQXZCO0FBQ0g7QUFDSjtBQWZHO0FBSmdCLGFBQWhCLEVBcUJUO0FBQ0MsMEJBQVU7QUFEWCxhQXJCUyxDQUFaO0FBd0JBLGdCQUFJLE9BQU8sS0FBSyxJQUFMLElBQWE7QUFDcEIsc0JBQU0sQ0FEYztBQUVwQix1QkFBTyxZQUZhO0FBR3BCLHlCQUFTO0FBSFcsYUFBeEI7QUFLQSxrQkFBTSxHQUFOLENBQVUsT0FBVixDQUFrQjtBQUNkLHNCQUFNLE9BQU8sSUFBUCxDQUFZLFVBQVosQ0FBdUIsTUFEZjtBQUVkLHVCQUFPLEtBQUssSUFGRTtBQUdkLDJCQUFXLEtBQUssS0FIRjtBQUlkLDZCQUFhLEtBQUssT0FKSjtBQUtkLDhCQUFjO0FBTEEsYUFBbEI7QUFPQSxtQkFBTyxLQUFQO0FBQ0gsU0E5UUk7O0FBZ1JMLHlCQUFpQix5QkFBQyxHQUFELEVBQU0sS0FBTixFQUFnQjtBQUM3QixnQkFBSSxRQUFRLE1BQU0sS0FBTixDQUFZLE1BQVosRUFBb0IsR0FBcEIsQ0FBd0IsZ0JBQVE7QUFDeEMsdUJBQU8sS0FBSyxLQUFMLENBQVcsS0FBWCxDQUFQO0FBQ0gsYUFGVyxDQUFaO0FBR0Esa0JBQU0sT0FBTixDQUFjLGdCQUFRO0FBQ2xCLG9CQUFJLE1BQU0sV0FBVyxLQUFLLENBQUwsQ0FBWCxDQUFWO0FBQ0Esb0JBQUksTUFBTSxXQUFXLEtBQUssQ0FBTCxDQUFYLENBQVY7QUFDQSxvQkFBSSxRQUFRLEtBQUssQ0FBTCxDQUFaO0FBQ0Esb0JBQUksT0FBTyxXQUFXLEtBQUssQ0FBTCxDQUFYLENBQVg7QUFDQSxvQkFBSSxVQUFVLFdBQVcsS0FBSyxDQUFMLENBQVgsQ0FBZDtBQUNBLG9CQUFJLE9BQU8sS0FBSyxDQUFMLENBQVg7QUFDQSxzQkFBTSxlQUFOLENBQXNCO0FBQ2xCLHlCQUFLLEdBRGE7QUFFbEIsMkJBQU87QUFDSCw2QkFBSyxHQURGO0FBRUgsNkJBQUs7QUFGRixxQkFGVztBQU1sQiwwQkFBTTtBQUNGLDhCQUFNLElBREo7QUFFRiwrQkFBTyxLQUZMO0FBR0YsaUNBQVM7QUFIUCxxQkFOWTtBQVdsQiwwQkFBTTtBQVhZLGlCQUF0QjtBQWFILGFBcEJEO0FBcUJBLGdCQUFJLFFBQVEsTUFBTSxPQUFOLENBQWMsQ0FBZCxDQUFaO0FBQ0EsZ0JBQUcsS0FBSCxFQUFTO0FBQ0wsb0JBQUksU0FBSixDQUFjO0FBQ1YseUJBQUssTUFBTSxJQUFOLENBQVcsR0FETjtBQUVWLHlCQUFLLE1BQU0sSUFBTixDQUFXO0FBRk4saUJBQWQ7QUFJSDtBQUNKLFNBaFRJOztBQWtUWDs7QUFFQSwyQkFBbUIsMkJBQUMsS0FBRCxFQUFXO0FBQzFCLGdCQUFJLGVBQWUsQ0FBQyxRQUFELEVBQVcsa0JBQVgsRUFBK0Isb0JBQS9CLENBQW5CO0FBQ0EseUJBQWEsT0FBYixDQUFxQixrQkFBVTtBQUMzQixzQkFBTSxJQUFOLENBQVc7QUFDVixpQ0FBYSxRQURIO0FBRVYsNkJBQVMsQ0FBQztBQUNULG9DQUFZO0FBREgscUJBQUQ7QUFGQyxpQkFBWDtBQU1ILGFBUEQ7QUFRQSxtQkFBTyxLQUFQO0FBQ0gsU0EvVFU7O0FBaVVYLHdCQUFnQix3QkFBQyxHQUFELEVBQU0sSUFBTixFQUFZLE1BQVosRUFBdUI7QUFDdEMsZ0JBQUksUUFBUSxNQUFNLGlCQUFOLENBQXdCLE1BQXhCLENBQVo7QUFDQSxnQkFBSSxnQkFBZ0IsSUFBSSxPQUFPLElBQVAsQ0FBWSxhQUFoQixDQUE4QixLQUE5QixFQUFxQztBQUN4RCxxQkFBSyxHQURtRDtBQUV4RCxzQkFBTTtBQUZrRCxhQUFyQyxDQUFwQjtBQUlBLGdCQUFJLFFBQUosQ0FBYSxHQUFiLENBQWlCLElBQWpCLEVBQXVCLGFBQXZCO0FBQ0EsZ0JBQUksWUFBSixDQUFpQixJQUFqQjtBQUNBLFNBelVVOztBQTJVWCwwQkFBa0IsMEJBQUMsR0FBRCxFQUFTO0FBQzFCLGdCQUFNLGtCQUFrQiw4RUFBeEI7O0FBRUEsZ0JBQUksVUFBVSxTQUFWLE9BQVUsQ0FBQyxJQUFELEVBQVU7QUFDdkIsdUJBQU8sSUFBSSxPQUFKLENBQVksVUFBQyxPQUFELEVBQVUsTUFBVixFQUFxQjtBQUN2QyxzQkFBRSxHQUFGLENBQU0sZUFBTixFQUF1QjtBQUN0Qiw4QkFBTTtBQURnQixxQkFBdkIsRUFFRyxVQUFDLEdBQUQsRUFBUztBQUNYLDRCQUFJLE1BQUosQ0FBVyxPQUFYLENBQW1CLGlCQUFTO0FBQzNCLGdDQUFHLE1BQU0sR0FBTixLQUFjLEdBQWpCLEVBQXFCO0FBQ3BCLHdDQUFRLEtBQVI7QUFDQTtBQUNELHlCQUpEO0FBS0EsNEJBQUksV0FBVyxJQUFJLFVBQUosQ0FBZSxXQUFmLEdBQTZCLENBQTVDO0FBQ0EsNEJBQUcsV0FBVyxJQUFJLFVBQUosQ0FBZSxVQUE3QixFQUF3QztBQUN2QyxtQ0FBTyx1QkFBUDtBQUNBLHlCQUZELE1BR0k7QUFDSCxvQ0FBUSxRQUFSLEVBQWtCLElBQWxCLENBQXVCLGtCQUFVO0FBQ2hDLHdDQUFRLE1BQVI7QUFDQSw2QkFGRCxFQUVHLEtBRkgsQ0FFUyxNQUZUO0FBR0E7QUFDRCxxQkFqQkQsRUFpQkcsS0FqQkgsQ0FpQlMsVUFBQyxLQUFELEVBQVEsVUFBUixFQUFvQixXQUFwQixFQUFvQztBQUM1QywrQkFBTyxXQUFQO0FBQ0EscUJBbkJEO0FBb0JBLGlCQXJCTSxDQUFQO0FBc0JBLGFBdkJEOztBQXlCQSxtQkFBTyxRQUFRLENBQVIsQ0FBUDtBQUNBLFNBeFdVOztBQTBXWCxtQkFBVyxtQkFBQyxRQUFELEVBQVcsUUFBWCxFQUF3QjtBQUN6QixvQkFBUSxRQUFSLElBQW9CLFFBQXBCO0FBQ0g7QUE1V0ksS0FBWjs7QUErV0EsV0FBTyxLQUFQO0FBQ0EsQ0FyWUQiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwid2luZG93LkF0bGFzID0gKCkgPT4ge1xuXG4gICAgbGV0IGhvdEtleXMgPSB7fTtcbiAgICBsZXQgc2hpZnREb3duID0gZmFsc2U7XG4gICAgbGV0IGtleUNoYXIgPSBmYWxzZTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGUgPT4ge1xuICAgICAgICBrZXlDaGFyID0gU3RyaW5nLmZyb21DaGFyQ29kZShlLndoaWNoKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgICAvL2lmKGUuc2hpZnRLZXkpe1xuICAgICAgICAvL2lmKGUuY3RybEtleSl7XG4gICAgICAgIGlmKGUuYWx0S2V5KXtcbiAgICAgICAgICAgIHNoaWZ0RG93biA9IHRydWU7XG4gICAgICAgICAgICBpZihob3RLZXlzW2tleUNoYXJdKXtcbiAgICAgICAgICAgICAgICBob3RLZXlzW2tleUNoYXJdKGUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2tleXVwJywgZSA9PiB7XG4gICAgICAgIHNoaWZ0RG93biA9IGZhbHNlO1xuICAgICAgICBrZXlDaGFyID0gZmFsc2U7XG4gICAgfSk7XG5cblx0bGV0IGF0bGFzID0ge1xuXG5cdFx0aW5pdDogKCkgPT4ge1xuXHRcdFx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcblx0XHRcdFx0Z29vZ2xlLm1hcHMuZXZlbnQuYWRkRG9tTGlzdGVuZXIod2luZG93LCAnbG9hZCcsIHJlc29sdmUpO1xuXHRcdFx0fSk7XG5cdFx0fSxcblxuICAgICAgICBzZXRNYXA6IChtYXApID0+IHtcbiAgICAgICAgICAgIGF0bGFzLm1hcCA9IG1hcDtcbiAgICAgICAgfSxcblxuICAgICAgICBpc1NoaWZ0Q2xpY2s6ICgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBzaGlmdERvd247XG4gICAgICAgIH0sXG5cblx0XHQvLyBNYXAgTWFya2Vyc1xuXG4gICAgICAgIG1hcDogZmFsc2UsXG4gICAgICAgIG1hcmtlcnM6IFtdLFxuXG4gICAgICAgIGFkZE1hcmtlcjogKGRhdGEsIG9wdGlvbnMpID0+IHtcbiAgICAgICAgXHRsZXQgb3B0ID0gb3B0aW9ucyB8fCB7fTtcbiAgICAgICAgICAgIGlmKCFkYXRhLm5hbWUpe1xuICAgICAgICAgICAgICAgIGRhdGEubmFtZSA9ICdMb2NhdGlvbiAnICsgKGF0bGFzLm1hcmtlcnMubGVuZ3RoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgXHRsZXQgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XG4gICAgICAgIFx0XHRwb3NpdGlvbjogbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhkYXRhLmxhdCwgZGF0YS5sbmcpLFxuICAgICAgICBcdFx0bWFwOiBkYXRhLm1hcCxcbiAgICAgICAgXHRcdHRpdGxlOiBkYXRhLm5hbWVcbiAgICAgICAgXHR9KTtcbiAgICAgICAgXHRsZXQgZW50cnkgPSB7XG4gICAgICAgIFx0XHRyZWY6IG1hcmtlcixcbiAgICAgICAgXHRcdGRhdGE6IGRhdGFcbiAgICAgICAgXHR9XG4gICAgICAgIFx0YXRsYXMubWFya2Vycy5wdXNoKGVudHJ5KTtcbiAgICAgICAgXHRsZXQgaWR4ID0gYXRsYXMubWFya2Vycy5sZW5ndGggLSAxO1xuICAgICAgICBcdGZvcihsZXQgZXZlbnQgaW4gZGF0YS5ldmVudHMpe1xuICAgICAgICBcdFx0Z29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFya2VyLCBldmVudCwgZSA9PiB7XG4gICAgICAgIFx0XHRcdGRhdGEuZXZlbnRzW2V2ZW50XShlLCBtYXJrZXIsIGlkeCk7XG4gICAgICAgIFx0XHR9KTtcbiAgICAgICAgXHR9XG4gICAgICAgIFx0aWYoIW9wdC5yZWFkT25seSl7XG4gICAgICAgIFx0XHRhdGxhcy5zYXZlTWFya2Vycyh3aW5kb3cuTUFQX1RBRywgYXRsYXMubWFya2Vycyk7XG4gICAgICAgIFx0fVxuICAgICAgICBcdHJldHVybiBlbnRyeTtcbiAgICAgICAgfSxcblxuICAgICAgICByZW1vdmVNYXJrZXI6IChpZHgsIG9wdGlvbnMpID0+IHtcbiAgICAgICAgXHRsZXQgb3B0ID0gb3B0aW9ucyB8fCB7fTtcbiAgICAgICAgXHRsZXQgZW50cnkgPSBhdGxhcy5tYXJrZXJzW2lkeF07XG4gICAgICAgIFx0aWYoZW50cnkpe1xuICAgICAgICBcdFx0ZW50cnkucmVmLnNldE1hcChudWxsKTtcbiAgICAgICAgXHRcdGF0bGFzLm1hcmtlcnNbaWR4XSA9IG51bGw7XG4gICAgICAgIFx0XHQvL21hcmtlcnMuc3BsaWNlKGlkeCwgMSk7XG4gICAgICAgIFx0fVxuXHRcdFx0aWYoIW9wdC5yZWFkT25seSl7XG4gICAgICAgIFx0XHRhdGxhcy5zYXZlTWFya2Vycyh3aW5kb3cuTUFQX1RBRywgYXRsYXMubWFya2Vycyk7XG4gICAgICAgIFx0fVxuICAgICAgICB9LFxuXG4gICAgICAgIC8qY2xlYXJNYXA6IChtYWtlcnMpID0+IHtcbiAgICAgICAgXHRtYXJrZXJzLmZvckVhY2goZW50cnkgPT4ge1xuICAgICAgICBcdFx0ZW50cnkucmVmLnNldE1hcChudWxsKTtcbiAgICAgICAgXHR9KTtcbiAgICAgICAgfSwqL1xuXG4gICAgICAgIHVwZGF0ZUljb25zOiAobWFya2VycywgY2FsbGJhY2spID0+IHtcbiAgICAgICAgXHRtYXJrZXJzLmZvckVhY2goKGVudHJ5LCBpZHgpID0+IHtcbiAgICAgICAgXHRcdGxldCBpY29uID0gZW50cnkucmVmLmdldEljb24oKTtcbiAgICAgICAgXHRcdGxldCBuZXdJY29uID0gY2FsbGJhY2soaWNvbiwgZW50cnksIGlkeCk7XG4gICAgICAgIFx0XHRlbnRyeS5yZWYuc2V0SWNvbihuZXdJY29uKTtcbiAgICAgICAgXHR9KTtcbiAgICAgICAgfSxcblxuXG4gICAgICAgIHVwZGF0ZU5hbWU6IChpZHgpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGVudHJ5ID0gYXRsYXMubWFya2Vyc1tpZHhdO1xuICAgICAgICAgICAgICAgIGxldCB2eCA9IHZleC5kaWFsb2cucHJvbXB0KHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ1VwZGF0ZSBNYXJrZXIgTmFtZScsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBlbnRyeS5kYXRhLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAnTG9jYXRpb24gJyArIGlkeCxcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2s6ICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYodmFsdWUpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVudHJ5LmRhdGEubmFtZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0bGFzLnNhdmVNYXJrZXJzKHdpbmRvdy5NQVBfVEFHLCBhdGxhcy5tYXJrZXJzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHRydWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgbWFya2Vyc1RvU3RyaW5nOiAobWFya2VycykgPT4ge1xuICAgICAgICAgICAgbGV0IG91dHB1dCA9ICcnO1xuICAgICAgICAgICAgbWFya2Vycy5mb3JFYWNoKChlbnRyeSwgaWR4KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYoZW50cnkgIT09IG51bGwpe1xuICAgICAgICAgICAgICAgICAgICBsZXQgY29vcmQgPSBlbnRyeS5yZWYucG9zaXRpb247XG4gICAgICAgICAgICAgICAgICAgIGxldCBuYW1lID0gZW50cnkuZGF0YS5uYW1lIHx8ICdMb2NhdGlvbiAnICsgaWR4O1xuICAgICAgICAgICAgICAgICAgICBvdXRwdXQgKz0gY29vcmQubGF0KCkgKyAnLCcgKyBjb29yZC5sbmcoKSArICcsJyArIG5hbWUgKyAnJCc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgICAgICB9LFxuXG4gICAgICAgIG1hcmtlcnNGcm9tU3RyaW5nOiAoc3RyKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gc3RyLnNwbGl0KCckJykubWFwKHBhaXIgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBjb29yZHMgPSBwYWlyLnNwbGl0KCcsJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvb3JkcztcbiAgICAgICAgICAgIH0pLmZpbHRlcihjb29yZHMgPT4gY29vcmRzLmxlbmd0aCAhPT0gMSkubWFwKChjb29yZHMsIGlkeCkgPT57XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbGF0OiBwYXJzZUZsb2F0KGNvb3Jkc1swXSksXG4gICAgICAgICAgICAgICAgICAgIGxuZzogcGFyc2VGbG9hdChjb29yZHNbMV0pLFxuICAgICAgICAgICAgICAgICAgICBuYW1lOiBjb29yZHNbMl0gfHwgJ0xvY2F0aW9uICcgKyBpZHhcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICBzYXZlTWFya2VyczogKHRhZywgbGlzdCkgPT4ge1xuICAgICAgICBcdGlmKHRhZyl7XG4gICAgICAgIFx0XHRsb2NhbFN0b3JhZ2Uuc2V0SXRlbSh0YWcsIGF0bGFzLm1hcmtlcnNUb1N0cmluZyhsaXN0KSk7XG4gICAgICAgIFx0fVxuICAgICAgICB9LFxuXG4gICAgICAgIGxvYWRNYXJrZXJzOiAodGFnKSA9PiB7XG4gICAgICAgIFx0bGV0IHN0ciA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKHRhZyk7XG4gICAgICAgIFx0cmV0dXJuIHN0ciA/IGF0bGFzLm1hcmtlcnNGcm9tU3RyaW5nKHN0cikgOiBmYWxzZTtcbiAgICAgICAgfSxcblxuICAgICAgICBsYXN0SW5mb1dpbmRvdzogZmFsc2UsXG5cbiAgICAgICAgYWRkRGVmYXVsdE1hcmtlcjogKGRhdGEpID0+IHtcblx0XHRcdGxldCBlbnRyeSA9IGF0bGFzLmFkZE1hcmtlcih7XG4gICAgICAgIFx0XHRtYXA6IGRhdGEubWFwLFxuICAgICAgICAgICAgICAgIG5hbWU6IGRhdGEubmFtZSxcbiAgICAgICAgXHRcdGxhdDogZGF0YS5jb29yZC5sYXQsXG4gICAgICAgIFx0XHRsbmc6IGRhdGEuY29vcmQubG5nLFxuICAgICAgICBcdFx0ZXZlbnRzOiB7XG4gICAgICAgIFx0XHRcdGNsaWNrOiAoZSwgbSwgaSkgPT4ge1xuICAgICAgICBcdFx0XHRcdGNvbnNvbGUubG9nKCdjbGljaycsIGkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYoYXRsYXMuaXNTaGlmdENsaWNrKCkpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0bGFzLnJlbW92ZU1hcmtlcihpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGVudHJ5ID0gYXRsYXMubWFya2Vyc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgaW5mbyA9IG5ldyBnb29nbGUubWFwcy5JbmZvV2luZG93KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogZW50cnkuZGF0YS5uYW1lXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYXRsYXMubWFwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5mby5vcGVuKGF0bGFzLm1hcCwgZW50cnkucmVmKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYXRsYXMubGFzdEluZm9XaW5kb3cpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXRsYXMubGFzdEluZm9XaW5kb3cuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0bGFzLmxhc3RJbmZvV2luZG93ID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXRsYXMubGFzdEluZm9XaW5kb3cgPSBpbmZvO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgXHRcdFx0fSxcbiAgICAgICAgXHRcdFx0ZGJsY2xpY2s6IChlLCBtLCBpKSA9PiB7XG4gICAgICAgIFx0XHRcdFx0Y29uc29sZS5sb2coJ2RibGNsaWNrJywgaSk7XG4gICAgICAgIFx0XHRcdFx0YXRsYXMudXBkYXRlTmFtZShpKS50aGVuKHVwZGF0ZWQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHVwZGF0ZWQpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihhdGxhcy5sYXN0SW5mb1dpbmRvdyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdGxhcy5sYXN0SW5mb1dpbmRvdy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXRsYXMubGFzdEluZm9XaW5kb3cgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICBcdFx0XHR9XG4gICAgICAgIFx0XHR9XG4gICAgICAgIFx0fSk7XG4gICAgICAgICAgICBlbnRyeS5yZWYuc2V0SWNvbih7XG4gICAgICAgICAgICAgICAgcGF0aDogZ29vZ2xlLm1hcHMuU3ltYm9sUGF0aC5DSVJDTEUsXG4gICAgICAgICAgICAgICAgc2NhbGU6IDcuNSxcbiAgICAgICAgICAgICAgICBmaWxsQ29sb3I6ICcjRjAwJyxcbiAgICAgICAgICAgICAgICBmaWxsT3BhY2l0eTogMC41LFxuICAgICAgICAgICAgICAgIHN0cm9rZVdlaWdodDogMFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZW50cnk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgYWRkVmlld01hcmtlcjogKGRhdGEpID0+IHtcblx0XHRcdGxldCBlbnRyeSA9IGF0bGFzLmFkZE1hcmtlcih7XG4gICAgICAgIFx0XHRtYXA6IGRhdGEubWFwLFxuICAgICAgICBcdFx0bGF0OiBkYXRhLmNvb3JkLmxhdCxcbiAgICAgICAgXHRcdGxuZzogZGF0YS5jb29yZC5sbmcsXG4gICAgICAgIFx0XHRldmVudHM6IHtcbiAgICAgICAgXHRcdFx0Y2xpY2s6IChlLCBtLCBpKSA9PiB7XG4gICAgICAgIFx0XHRcdFx0Y29uc29sZS5sb2coJ2NsaWNrJywgaSwgZGF0YSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZW50cnkgPSBhdGxhcy5tYXJrZXJzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGVudHJ5RGF0YSA9IGVudHJ5LmRhdGE7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgbG9jTmFtZSA9IGVudHJ5RGF0YS5uYW1lIHx8ICdMb2NhdGlvbiAnICsgaTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBsb2NEYXRhID0gYFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxoMz4ke2xvY05hbWV9PC9oMz5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dWw+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsaT5UaW1lOiAke2VudHJ5RGF0YS50aW1lfTwvbGk+XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsaT5JbmZlY3RlZDogJHtlbnRyeURhdGEuaW5mZWN0ZWR9PC9saT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8L3VsPlxuICAgICAgICAgICAgICAgICAgICAgICAgYDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpbmZvID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGxvY0RhdGFcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYoYXRsYXMubWFwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvLm9wZW4oYXRsYXMubWFwLCBlbnRyeS5yZWYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGF0bGFzLmxhc3RJbmZvV2luZG93KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXRsYXMubGFzdEluZm9XaW5kb3cuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXRsYXMubGFzdEluZm9XaW5kb3cgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXRsYXMubGFzdEluZm9XaW5kb3cgPSBpbmZvO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICBcdFx0XHR9XG4gICAgICAgIFx0XHR9XG4gICAgICAgIFx0fSwge1xuICAgICAgICBcdFx0cmVhZE9ubHk6IHRydWVcbiAgICAgICAgXHR9KTtcbiAgICAgICAgXHRsZXQgaWNvbiA9IGRhdGEuaWNvbiB8fCB7XG4gICAgICAgIFx0XHRzY2FsZTogMFxuICAgICAgICBcdH07XG4gICAgICAgIFx0ZW50cnkucmVmLnNldEljb24oe1xuICAgICAgICBcdFx0cGF0aDogZ29vZ2xlLm1hcHMuU3ltYm9sUGF0aC5DSVJDTEUsXG4gICAgICAgIFx0XHRzY2FsZTogKDEuMCkgKyAoOS4wICogaWNvbi5zY2FsZSksXG4gICAgICAgIFx0XHRmaWxsQ29sb3I6ICcjRjAwJyxcbiAgICAgICAgXHRcdGZpbGxPcGFjaXR5OiAwLjUsXG4gICAgICAgIFx0XHRzdHJva2VXZWlnaHQ6IDBcbiAgICAgICAgXHR9KTtcbiAgICAgICAgXHRyZXR1cm4gZW50cnk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgYWRkQ3VzdG9tTWFya2VyOiAoZGF0YSkgPT4ge1xuICAgICAgICAgICAgbGV0IGVudHJ5ID0gYXRsYXMuYWRkTWFya2VyKHtcbiAgICAgICAgICAgICAgICBtYXA6IGRhdGEubWFwLFxuICAgICAgICAgICAgICAgIGxhdDogZGF0YS5jb29yZC5sYXQsXG4gICAgICAgICAgICAgICAgbG5nOiBkYXRhLmNvb3JkLmxuZyxcbiAgICAgICAgICAgICAgICBldmVudHM6IHtcbiAgICAgICAgICAgICAgICAgICAgY2xpY2s6IChlLCBtLCBpKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnY2xpY2snLCBpLCBkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlbnRyeSA9IGF0bGFzLm1hcmtlcnNbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgaW5mbyA9IG5ldyBnb29nbGUubWFwcy5JbmZvV2luZG93KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBkYXRhLnRleHRcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYoYXRsYXMubWFwKXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvLm9wZW4oYXRsYXMubWFwLCBlbnRyeS5yZWYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGF0bGFzLmxhc3RJbmZvV2luZG93KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXRsYXMubGFzdEluZm9XaW5kb3cuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXRsYXMubGFzdEluZm9XaW5kb3cgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXRsYXMubGFzdEluZm9XaW5kb3cgPSBpbmZvO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSwge1xuICAgICAgICAgICAgICAgIHJlYWRPbmx5OiB0cnVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGxldCBpY29uID0gZGF0YS5pY29uIHx8IHtcbiAgICAgICAgICAgICAgICBzaXplOiAwLFxuICAgICAgICAgICAgICAgIGNvbG9yOiAncmdiKDAsMCwwKScsXG4gICAgICAgICAgICAgICAgb3BhY2l0eTogMS4wXG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgZW50cnkucmVmLnNldEljb24oe1xuICAgICAgICAgICAgICAgIHBhdGg6IGdvb2dsZS5tYXBzLlN5bWJvbFBhdGguQ0lSQ0xFLFxuICAgICAgICAgICAgICAgIHNjYWxlOiBpY29uLnNpemUsXG4gICAgICAgICAgICAgICAgZmlsbENvbG9yOiBpY29uLmNvbG9yLFxuICAgICAgICAgICAgICAgIGZpbGxPcGFjaXR5OiBpY29uLm9wYWNpdHksXG4gICAgICAgICAgICAgICAgc3Ryb2tlV2VpZ2h0OiAwXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBlbnRyeTtcbiAgICAgICAgfSxcblxuICAgICAgICBsb2FkTWFwRnJvbURhdGE6IChtYXAsIHZhbHVlKSA9PiB7XG4gICAgICAgICAgICBsZXQgaW5wdXQgPSB2YWx1ZS5zcGxpdCgnJEBAJCcpLm1hcChsaW5lID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbGluZS5zcGxpdCgnJEAkJyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGlucHV0LmZvckVhY2goZGF0YSA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGxhdCA9IHBhcnNlRmxvYXQoZGF0YVswXSk7XG4gICAgICAgICAgICAgICAgbGV0IGxuZyA9IHBhcnNlRmxvYXQoZGF0YVsxXSk7XG4gICAgICAgICAgICAgICAgbGV0IGNvbG9yID0gZGF0YVsyXTtcbiAgICAgICAgICAgICAgICBsZXQgc2l6ZSA9IHBhcnNlRmxvYXQoZGF0YVszXSk7XG4gICAgICAgICAgICAgICAgbGV0IG9wYWNpdHkgPSBwYXJzZUZsb2F0KGRhdGFbNF0pO1xuICAgICAgICAgICAgICAgIGxldCB0ZXh0ID0gZGF0YVs1XTtcbiAgICAgICAgICAgICAgICBhdGxhcy5hZGRDdXN0b21NYXJrZXIoe1xuICAgICAgICAgICAgICAgICAgICBtYXA6IG1hcCxcbiAgICAgICAgICAgICAgICAgICAgY29vcmQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhdDogbGF0LFxuICAgICAgICAgICAgICAgICAgICAgICAgbG5nOiBsbmdcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgaWNvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2l6ZTogc2l6ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBjb2xvcixcbiAgICAgICAgICAgICAgICAgICAgICAgIG9wYWNpdHk6IG9wYWNpdHlcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogdGV4dFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBsZXQgZmlyc3QgPSBhdGxhcy5tYXJrZXJzWzBdO1xuICAgICAgICAgICAgaWYoZmlyc3Qpe1xuICAgICAgICAgICAgICAgIG1hcC5zZXRDZW50ZXIoe1xuICAgICAgICAgICAgICAgICAgICBsYXQ6IGZpcnN0LmRhdGEubGF0LFxuICAgICAgICAgICAgICAgICAgICBsbmc6IGZpcnN0LmRhdGEubG5nXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cblx0XHQvLyBNYXAgVGhlbWVzXG5cblx0XHRyZW1vdmVUaGVtZUxhYmVsczogKHRoZW1lKSA9PiB7XG5cdFx0ICAgIGxldCBlbGVtZW50VHlwZXMgPSBbJ2xhYmVscycsICdsYWJlbHMudGV4dC5maWxsJywgJ2xhYmVscy50ZXh0LnN0cm9rZSddO1xuXHRcdCAgICBlbGVtZW50VHlwZXMuZm9yRWFjaChlbFR5cGUgPT4ge1xuXHRcdCAgICAgICAgdGhlbWUucHVzaCh7XG5cdFx0ICAgICAgICBcdGVsZW1lbnRUeXBlOiAnbGFiZWxzJyxcblx0XHQgICAgICAgIFx0c3R5bGVyczogW3tcblx0XHQgICAgICAgIFx0XHR2aXNpYmlsaXR5OiAnb2ZmJ1xuXHRcdCAgICAgICAgXHR9XVxuXHRcdCAgICAgICAgfSk7XG5cdFx0ICAgIH0pO1xuXHRcdCAgICByZXR1cm4gdGhlbWU7XG5cdFx0fSxcblxuXHRcdGNoYW5nZU1hcFN0eWxlOiAobWFwLCBuYW1lLCBzdHlsZXMpID0+IHtcblx0XHRcdGxldCB0aGVtZSA9IGF0bGFzLnJlbW92ZVRoZW1lTGFiZWxzKHN0eWxlcyk7XG5cdFx0XHRsZXQgc3R5bGVkTWFwVHlwZSA9IG5ldyBnb29nbGUubWFwcy5TdHlsZWRNYXBUeXBlKHRoZW1lLCB7XG5cdFx0XHRcdG1hcDogbWFwLFxuXHRcdFx0XHRuYW1lOiBuYW1lXG5cdFx0XHR9KTtcblx0XHRcdG1hcC5tYXBUeXBlcy5zZXQobmFtZSwgc3R5bGVkTWFwVHlwZSk7XG5cdFx0XHRtYXAuc2V0TWFwVHlwZUlkKG5hbWUpO1xuXHRcdH0sXG5cblx0XHRnZXRNYXBTdHlsZUJ5VVJMOiAodXJsKSA9PiB7XG5cdFx0XHRjb25zdCBTTkFaWllfTUFQU19VUkwgPSAnaHR0cHM6Ly9zbmF6enltYXBzLmNvbS9leHBsb3JlLmpzb24/a2V5PTZmYmIwYTc0LWVjNjctNDMyOS04M2VlLTE1ZWRkNDc0MGM0Yic7XG5cblx0XHRcdGxldCBnZXRQYWdlID0gKHBhZ2UpID0+IHtcblx0XHRcdFx0cmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcblx0XHRcdFx0XHQkLmdldChTTkFaWllfTUFQU19VUkwsIHtcblx0XHRcdFx0XHRcdHBhZ2U6IHBhZ2Vcblx0XHRcdFx0XHR9LCAocmVzKSA9PiB7XG5cdFx0XHRcdFx0XHRyZXMuc3R5bGVzLmZvckVhY2goc3R5bGUgPT4ge1xuXHRcdFx0XHRcdFx0XHRpZihzdHlsZS51cmwgPT09IHVybCl7XG5cdFx0XHRcdFx0XHRcdFx0cmVzb2x2ZShzdHlsZSk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0bGV0IG5leHRQYWdlID0gcmVzLnBhZ2luYXRpb24uY3VycmVudFBhZ2UgKyAxO1xuXHRcdFx0XHRcdFx0aWYobmV4dFBhZ2UgPiByZXMucGFnaW5hdGlvbi50b3RhbFBhZ2VzKXtcblx0XHRcdFx0XHRcdFx0cmVqZWN0KCdDb3VsZCBub3QgZmluZCBzdHlsZS4nKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGVsc2V7XG5cdFx0XHRcdFx0XHRcdGdldFBhZ2UobmV4dFBhZ2UpLnRoZW4ocmVjUmVzID0+IHtcblx0XHRcdFx0XHRcdFx0XHRyZXNvbHZlKHJlY1Jlcyk7XG5cdFx0XHRcdFx0XHRcdH0pLmNhdGNoKHJlamVjdCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSkuZXJyb3IoKGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bikgPT4ge1xuXHRcdFx0XHRcdFx0cmVqZWN0KGVycm9yVGhyb3duKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdHJldHVybiBnZXRQYWdlKDEpO1xuXHRcdH0sXG5cblx0XHRzZXRIb3RLZXk6IChzaG9ydGN1dCwgY2FsbGJhY2spID0+IHtcbiAgICAgICAgICAgIGhvdEtleXNbc2hvcnRjdXRdID0gY2FsbGJhY2s7XG4gICAgICAgIH1cblx0fVxuXG5cdHJldHVybiBhdGxhcztcbn0iXX0=\n"]}