{"version":3,"sources":["atlas.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","window","Atlas","hotKeys","shiftDown","keyChar","addEventListener","String","fromCharCode","which","toLowerCase","shiftKey","atlas","init","Promise","resolve","reject","google","maps","event","addDomListener","setMap","map","isShiftClick","markers","addMarker","data","options","opt","name","marker","Marker","position","LatLng","lat","lng","title","entry","ref","push","idx","events","addListener","readOnly","saveMarkers","MAP_TAG","removeMarker","updateIcons","callback","forEach","icon","getIcon","newIcon","setIcon","updateName","vex","dialog","prompt","message","value","placeholder","markersToString","output","coord","markersFromString","str","split","pair","filter","coords","parseFloat","tag","list","localStorage","setItem","loadMarkers","getItem","lastInfoWindow","addDefaultMarker","click","m","console","log","_entry","info","InfoWindow","content","open","close","dblclick","then","updated","path","SymbolPath","CIRCLE","scale","fillColor","fillOpacity","strokeWeight","addViewMarker","entryData","locData","time","infected","addCustomMarker","text","size","color","opacity","loadMapFromData","line","first","setCenter","removeThemeLabels","theme","elType","elementType","stylers","visibility","changeMapStyle","styles","styledMapType","StyledMapType","mapTypes","set","setMapTypeId","getMapStyleByURL","url","getPage","page","$","get","res","style","nextPage","pagination","currentPage","totalPages","recRes","catch","error","jqXHR","textStatus","errorThrown","setHotKey","shortcut"],"mappings":"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","file":"../atlas.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nwindow.Atlas = function () {\n\n    var hotKeys = {};\n    var shiftDown = false;\n    var keyChar = false;\n    window.addEventListener('keydown', function (e) {\n        keyChar = String.fromCharCode(e.which).toLowerCase();\n        if (e.shiftKey) {\n            shiftDown = true;\n            if (hotKeys[keyChar]) {\n                hotKeys[keyChar](e);\n            }\n        }\n    });\n    window.addEventListener('keyup', function (e) {\n        shiftDown = false;\n        keyChar = false;\n    });\n\n    var atlas = {\n\n        init: function init() {\n            return new Promise(function (resolve, reject) {\n                google.maps.event.addDomListener(window, 'load', resolve);\n            });\n        },\n\n        setMap: function setMap(map) {\n            atlas.map = map;\n        },\n\n        isShiftClick: function isShiftClick() {\n            return shiftDown;\n        },\n\n        // Map Markers\n\n        map: false,\n        markers: [],\n\n        addMarker: function addMarker(data, options) {\n            var opt = options || {};\n            if (!data.name) {\n                data.name = 'Location ' + atlas.markers.length;\n            }\n            var marker = new google.maps.Marker({\n                position: new google.maps.LatLng(data.lat, data.lng),\n                map: data.map,\n                title: data.name\n            });\n            var entry = {\n                ref: marker,\n                data: data\n            };\n            atlas.markers.push(entry);\n            var idx = atlas.markers.length - 1;\n\n            var _loop = function _loop(event) {\n                google.maps.event.addListener(marker, event, function (e) {\n                    data.events[event](e, marker, idx);\n                });\n            };\n\n            for (var event in data.events) {\n                _loop(event);\n            }\n            if (!opt.readOnly) {\n                atlas.saveMarkers(window.MAP_TAG, atlas.markers);\n            }\n            return entry;\n        },\n\n        removeMarker: function removeMarker(idx, options) {\n            var opt = options || {};\n            var entry = atlas.markers[idx];\n            if (entry) {\n                entry.ref.setMap(null);\n                atlas.markers[idx] = null;\n                //markers.splice(idx, 1);\n            }\n            if (!opt.readOnly) {\n                atlas.saveMarkers(window.MAP_TAG, atlas.markers);\n            }\n        },\n\n        /*clearMap: (makers) => {\n        \tmarkers.forEach(entry => {\n        \t\tentry.ref.setMap(null);\n        \t});\n        },*/\n\n        updateIcons: function updateIcons(markers, callback) {\n            markers.forEach(function (entry, idx) {\n                var icon = entry.ref.getIcon();\n                var newIcon = callback(icon, entry, idx);\n                entry.ref.setIcon(newIcon);\n            });\n        },\n\n        updateName: function updateName(idx) {\n            return new Promise(function (resolve, reject) {\n                var entry = atlas.markers[idx];\n                var vx = vex.dialog.prompt({\n                    message: 'Update Marker Name',\n                    value: entry.data.name,\n                    placeholder: 'Location ' + idx,\n                    callback: function callback(value) {\n                        if (value) {\n                            entry.data.name = value;\n                            atlas.saveMarkers(window.MAP_TAG, atlas.markers);\n                            resolve(true);\n                        } else {\n                            resolve(false);\n                        }\n                    }\n                });\n            });\n        },\n\n        markersToString: function markersToString(markers) {\n            var output = '';\n            markers.forEach(function (entry, idx) {\n                if (entry !== null) {\n                    var coord = entry.ref.position;\n                    var name = entry.data.name || 'Location ' + idx;\n                    output += coord.lat() + ',' + coord.lng() + ',' + name + '$';\n                }\n            });\n            return output;\n        },\n\n        markersFromString: function markersFromString(str) {\n            return str.split('$').map(function (pair) {\n                var coords = pair.split(',');\n                return coords;\n            }).filter(function (coords) {\n                return coords.length !== 1;\n            }).map(function (coords, idx) {\n                return {\n                    lat: parseFloat(coords[0]),\n                    lng: parseFloat(coords[1]),\n                    name: coords[2] || 'Location ' + idx\n                };\n            });\n        },\n\n        saveMarkers: function saveMarkers(tag, list) {\n            if (tag) {\n                localStorage.setItem(tag, atlas.markersToString(list));\n            }\n        },\n\n        loadMarkers: function loadMarkers(tag) {\n            var str = localStorage.getItem(tag);\n            return str ? atlas.markersFromString(str) : false;\n        },\n\n        lastInfoWindow: false,\n\n        addDefaultMarker: function addDefaultMarker(data) {\n            var entry = atlas.addMarker({\n                map: data.map,\n                name: data.name,\n                lat: data.coord.lat,\n                lng: data.coord.lng,\n                events: {\n                    click: function click(e, m, i) {\n                        console.log('click', i);\n                        if (atlas.isShiftClick()) {\n                            atlas.removeMarker(i);\n                        } else {\n                            var _entry = atlas.markers[i];\n                            var info = new google.maps.InfoWindow({\n                                content: _entry.data.name\n                            });\n                            if (atlas.map) {\n                                info.open(atlas.map, _entry.ref);\n                                if (atlas.lastInfoWindow) {\n                                    atlas.lastInfoWindow.close();\n                                    atlas.lastInfoWindow = false;\n                                }\n                                atlas.lastInfoWindow = info;\n                            }\n                        }\n                    },\n                    dblclick: function dblclick(e, m, i) {\n                        console.log('dblclick', i);\n                        atlas.updateName(i).then(function (updated) {\n                            if (updated) {\n                                if (atlas.lastInfoWindow) {\n                                    atlas.lastInfoWindow.close();\n                                    atlas.lastInfoWindow = false;\n                                }\n                            }\n                        });\n                    }\n                }\n            });\n            entry.ref.setIcon({\n                path: google.maps.SymbolPath.CIRCLE,\n                scale: 7.5,\n                fillColor: '#F00',\n                fillOpacity: 0.5,\n                strokeWeight: 0\n            });\n            return entry;\n        },\n\n        addViewMarker: function addViewMarker(data) {\n            var entry = atlas.addMarker({\n                map: data.map,\n                lat: data.coord.lat,\n                lng: data.coord.lng,\n                events: {\n                    click: function click(e, m, i) {\n                        console.log('click', i, data);\n                        var entry = atlas.markers[i];\n                        var entryData = entry.data;\n                        var locName = entryData.name || 'Location ' + i;\n                        var locData = '\\n                            <h3>' + locName + '</h3>\\n                            <ul>\\n                                <li>Time: ' + entryData.time + '</li>\\n                                <li>Infected: ' + entryData.infected + '</li>\\n                            </ul>\\n                        ';\n                        var info = new google.maps.InfoWindow({\n                            content: locData\n                        });\n                        if (atlas.map) {\n                            info.open(atlas.map, entry.ref);\n                            if (atlas.lastInfoWindow) {\n                                atlas.lastInfoWindow.close();\n                                atlas.lastInfoWindow = false;\n                            }\n                            atlas.lastInfoWindow = info;\n                        }\n                    }\n                }\n            }, {\n                readOnly: true\n            });\n            var icon = data.icon || {\n                scale: 0\n            };\n            entry.ref.setIcon({\n                path: google.maps.SymbolPath.CIRCLE,\n                scale: 1.0 + 9.0 * icon.scale,\n                fillColor: '#F00',\n                fillOpacity: 0.5,\n                strokeWeight: 0\n            });\n            return entry;\n        },\n\n        addCustomMarker: function addCustomMarker(data) {\n            var entry = atlas.addMarker({\n                map: data.map,\n                lat: data.coord.lat,\n                lng: data.coord.lng,\n                events: {\n                    click: function click(e, m, i) {\n                        console.log('click', i, data);\n                        var entry = atlas.markers[i];\n                        var info = new google.maps.InfoWindow({\n                            content: data.text\n                        });\n                        if (atlas.map) {\n                            info.open(atlas.map, entry.ref);\n                            if (atlas.lastInfoWindow) {\n                                atlas.lastInfoWindow.close();\n                                atlas.lastInfoWindow = false;\n                            }\n                            atlas.lastInfoWindow = info;\n                        }\n                    }\n                }\n            }, {\n                readOnly: true\n            });\n            var icon = data.icon || {\n                size: 0,\n                color: 'rgb(0,0,0)',\n                opacity: 1.0\n            };\n            entry.ref.setIcon({\n                path: google.maps.SymbolPath.CIRCLE,\n                scale: icon.size,\n                fillColor: icon.color,\n                fillOpacity: icon.opacity,\n                strokeWeight: 0\n            });\n            return entry;\n        },\n\n        loadMapFromData: function loadMapFromData(map, value) {\n            var input = value.split('$@@$').map(function (line) {\n                return line.split('$@$');\n            });\n            input.forEach(function (data) {\n                var lat = parseFloat(data[0]);\n                var lng = parseFloat(data[1]);\n                var color = data[2];\n                var size = parseFloat(data[3]);\n                var opacity = parseFloat(data[4]);\n                var text = data[5];\n                atlas.addCustomMarker({\n                    map: map,\n                    coord: {\n                        lat: lat,\n                        lng: lng\n                    },\n                    icon: {\n                        size: size,\n                        color: color,\n                        opacity: opacity\n                    },\n                    text: text\n                });\n            });\n            var first = atlas.markers[0];\n            if (first) {\n                map.setCenter({\n                    lat: first.data.lat,\n                    lng: first.data.lng\n                });\n            }\n        },\n\n        // Map Themes\n\n        removeThemeLabels: function removeThemeLabels(theme) {\n            var elementTypes = ['labels', 'labels.text.fill', 'labels.text.stroke'];\n            elementTypes.forEach(function (elType) {\n                theme.push({\n                    elementType: 'labels',\n                    stylers: [{\n                        visibility: 'off'\n                    }]\n                });\n            });\n            return theme;\n        },\n\n        changeMapStyle: function changeMapStyle(map, name, styles) {\n            var theme = atlas.removeThemeLabels(styles);\n            var styledMapType = new google.maps.StyledMapType(theme, {\n                map: map,\n                name: name\n            });\n            map.mapTypes.set(name, styledMapType);\n            map.setMapTypeId(name);\n        },\n\n        getMapStyleByURL: function getMapStyleByURL(url) {\n            var SNAZZY_MAPS_URL = 'https://snazzymaps.com/explore.json?key=6fbb0a74-ec67-4329-83ee-15edd4740c4b';\n\n            var getPage = function getPage(page) {\n                return new Promise(function (resolve, reject) {\n                    $.get(SNAZZY_MAPS_URL, {\n                        page: page\n                    }, function (res) {\n                        res.styles.forEach(function (style) {\n                            if (style.url === url) {\n                                resolve(style);\n                            }\n                        });\n                        var nextPage = res.pagination.currentPage + 1;\n                        if (nextPage > res.pagination.totalPages) {\n                            reject('Could not find style.');\n                        } else {\n                            getPage(nextPage).then(function (recRes) {\n                                resolve(recRes);\n                            }).catch(reject);\n                        }\n                    }).error(function (jqXHR, textStatus, errorThrown) {\n                        reject(errorThrown);\n                    });\n                });\n            };\n\n            return getPage(1);\n        },\n\n        setHotKey: function setHotKey(shortcut, callback) {\n            hotKeys[shortcut] = callback;\n        }\n    };\n\n    return atlas;\n};\n\n},{}]},{},[1])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvYXRsYXMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7OztBQ0FBLE9BQU8sS0FBUCxHQUFlLFlBQU07O0FBRWpCLFFBQUksVUFBVSxFQUFkO0FBQ0EsUUFBSSxZQUFZLEtBQWhCO0FBQ0EsUUFBSSxVQUFVLEtBQWQ7QUFDQSxXQUFPLGdCQUFQLENBQXdCLFNBQXhCLEVBQW1DLGFBQUs7QUFDcEMsa0JBQVUsT0FBTyxZQUFQLENBQW9CLEVBQUUsS0FBdEIsRUFBNkIsV0FBN0IsRUFBVjtBQUNBLFlBQUcsRUFBRSxRQUFMLEVBQWM7QUFDVix3QkFBWSxJQUFaO0FBQ0EsZ0JBQUcsUUFBUSxPQUFSLENBQUgsRUFBb0I7QUFDaEIsd0JBQVEsT0FBUixFQUFpQixDQUFqQjtBQUNIO0FBQ0o7QUFDSixLQVJEO0FBU0EsV0FBTyxnQkFBUCxDQUF3QixPQUF4QixFQUFpQyxhQUFLO0FBQ2xDLG9CQUFZLEtBQVo7QUFDQSxrQkFBVSxLQUFWO0FBQ0gsS0FIRDs7QUFLSCxRQUFJLFFBQVE7O0FBRVgsY0FBTSxnQkFBTTtBQUNYLG1CQUFPLElBQUksT0FBSixDQUFZLFVBQUMsT0FBRCxFQUFVLE1BQVYsRUFBcUI7QUFDdkMsdUJBQU8sSUFBUCxDQUFZLEtBQVosQ0FBa0IsY0FBbEIsQ0FBaUMsTUFBakMsRUFBeUMsTUFBekMsRUFBaUQsT0FBakQ7QUFDQSxhQUZNLENBQVA7QUFHQSxTQU5VOztBQVFMLGdCQUFRLGdCQUFDLEdBQUQsRUFBUztBQUNiLGtCQUFNLEdBQU4sR0FBWSxHQUFaO0FBQ0gsU0FWSTs7QUFZTCxzQkFBYyx3QkFBTTtBQUNoQixtQkFBTyxTQUFQO0FBQ0gsU0FkSTs7QUFnQlg7O0FBRU0sYUFBSyxLQWxCQTtBQW1CTCxpQkFBUyxFQW5CSjs7QUFxQkwsbUJBQVcsbUJBQUMsSUFBRCxFQUFPLE9BQVAsRUFBbUI7QUFDN0IsZ0JBQUksTUFBTSxXQUFXLEVB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bGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJ3aW5kb3cuQXRsYXMgPSAoKSA9PiB7XG5cbiAgICBsZXQgaG90S2V5cyA9IHt9O1xuICAgIGxldCBzaGlmdERvd24gPSBmYWxzZTtcbiAgICBsZXQga2V5Q2hhciA9IGZhbHNlO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZSA9PiB7XG4gICAgICAgIGtleUNoYXIgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGUud2hpY2gpLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIGlmKGUuc2hpZnRLZXkpe1xuICAgICAgICAgICAgc2hpZnREb3duID0gdHJ1ZTtcbiAgICAgICAgICAgIGlmKGhvdEtleXNba2V5Q2hhcl0pe1xuICAgICAgICAgICAgICAgIGhvdEtleXNba2V5Q2hhcl0oZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBlID0+IHtcbiAgICAgICAgc2hpZnREb3duID0gZmFsc2U7XG4gICAgICAgIGtleUNoYXIgPSBmYWxzZTtcbiAgICB9KTtcblxuXHRsZXQgYXRsYXMgPSB7XG5cblx0XHRpbml0OiAoKSA9PiB7XG5cdFx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0XHRnb29nbGUubWFwcy5ldmVudC5hZGREb21MaXN0ZW5lcih3aW5kb3csICdsb2FkJywgcmVzb2x2ZSk7XG5cdFx0XHR9KTtcblx0XHR9LFxuXG4gICAgICAgIHNldE1hcDogKG1hcCkgPT4ge1xuICAgICAgICAgICAgYXRsYXMubWFwID0gbWFwO1xuICAgICAgICB9LFxuXG4gICAgICAgIGlzU2hpZnRDbGljazogKCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIHNoaWZ0RG93bjtcbiAgICAgICAgfSxcblxuXHRcdC8vIE1hcCBNYXJrZXJzXG5cbiAgICAgICAgbWFwOiBmYWxzZSxcbiAgICAgICAgbWFya2VyczogW10sXG5cbiAgICAgICAgYWRkTWFya2VyOiAoZGF0YSwgb3B0aW9ucykgPT4ge1xuICAgICAgICBcdGxldCBvcHQgPSBvcHRpb25zIHx8IHt9O1xuICAgICAgICAgICAgaWYoIWRhdGEubmFtZSl7XG4gICAgICAgICAgICAgICAgZGF0YS5uYW1lID0gJ0xvY2F0aW9uICcgKyAoYXRsYXMubWFya2Vycy5sZW5ndGgpO1xuICAgICAgICAgICAgfVxuICAgICAgICBcdGxldCBtYXJrZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTWFya2VyKHtcbiAgICAgICAgXHRcdHBvc2l0aW9uOiBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGRhdGEubGF0LCBkYXRhLmxuZyksXG4gICAgICAgIFx0XHRtYXA6IGRhdGEubWFwLFxuICAgICAgICBcdFx0dGl0bGU6IGRhdGEubmFtZVxuICAgICAgICBcdH0pO1xuICAgICAgICBcdGxldCBlbnRyeSA9IHtcbiAgICAgICAgXHRcdHJlZjogbWFya2VyLFxuICAgICAgICBcdFx0ZGF0YTogZGF0YVxuICAgICAgICBcdH1cbiAgICAgICAgXHRhdGxhcy5tYXJrZXJzLnB1c2goZW50cnkpO1xuICAgICAgICBcdGxldCBpZHggPSBhdGxhcy5tYXJrZXJzLmxlbmd0aCAtIDE7XG4gICAgICAgIFx0Zm9yKGxldCBldmVudCBpbiBkYXRhLmV2ZW50cyl7XG4gICAgICAgIFx0XHRnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsIGV2ZW50LCBlID0+IHtcbiAgICAgICAgXHRcdFx0ZGF0YS5ldmVudHNbZXZlbnRdKGUsIG1hcmtlciwgaWR4KTtcbiAgICAgICAgXHRcdH0pO1xuICAgICAgICBcdH1cbiAgICAgICAgXHRpZighb3B0LnJlYWRPbmx5KXtcbiAgICAgICAgXHRcdGF0bGFzLnNhdmVNYXJrZXJzKHdpbmRvdy5NQVBfVEFHLCBhdGxhcy5tYXJrZXJzKTtcbiAgICAgICAgXHR9XG4gICAgICAgIFx0cmV0dXJuIGVudHJ5O1xuICAgICAgICB9LFxuXG4gICAgICAgIHJlbW92ZU1hcmtlcjogKGlkeCwgb3B0aW9ucykgPT4ge1xuICAgICAgICBcdGxldCBvcHQgPSBvcHRpb25zIHx8IHt9O1xuICAgICAgICBcdGxldCBlbnRyeSA9IGF0bGFzLm1hcmtlcnNbaWR4XTtcbiAgICAgICAgXHRpZihlbnRyeSl7XG4gICAgICAgIFx0XHRlbnRyeS5yZWYuc2V0TWFwKG51bGwpO1xuICAgICAgICBcdFx0YXRsYXMubWFya2Vyc1tpZHhdID0gbnVsbDtcbiAgICAgICAgXHRcdC8vbWFya2Vycy5zcGxpY2UoaWR4LCAxKTtcbiAgICAgICAgXHR9XG5cdFx0XHRpZighb3B0LnJlYWRPbmx5KXtcbiAgICAgICAgXHRcdGF0bGFzLnNhdmVNYXJrZXJzKHdpbmRvdy5NQVBfVEFHLCBhdGxhcy5tYXJrZXJzKTtcbiAgICAgICAgXHR9XG4gICAgICAgIH0sXG5cbiAgICAgICAgLypjbGVhck1hcDogKG1ha2VycykgPT4ge1xuICAgICAgICBcdG1hcmtlcnMuZm9yRWFjaChlbnRyeSA9PiB7XG4gICAgICAgIFx0XHRlbnRyeS5yZWYuc2V0TWFwKG51bGwpO1xuICAgICAgICBcdH0pO1xuICAgICAgICB9LCovXG5cbiAgICAgICAgdXBkYXRlSWNvbnM6IChtYXJrZXJzLCBjYWxsYmFjaykgPT4ge1xuICAgICAgICBcdG1hcmtlcnMuZm9yRWFjaCgoZW50cnksIGlkeCkgPT4ge1xuICAgICAgICBcdFx0bGV0IGljb24gPSBlbnRyeS5yZWYuZ2V0SWNvbigpO1xuICAgICAgICBcdFx0bGV0IG5ld0ljb24gPSBjYWxsYmFjayhpY29uLCBlbnRyeSwgaWR4KTtcbiAgICAgICAgXHRcdGVudHJ5LnJlZi5zZXRJY29uKG5ld0ljb24pO1xuICAgICAgICBcdH0pO1xuICAgICAgICB9LFxuXG5cbiAgICAgICAgdXBkYXRlTmFtZTogKGlkeCkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgZW50cnkgPSBhdGxhcy5tYXJrZXJzW2lkeF07XG4gICAgICAgICAgICAgICAgbGV0IHZ4ID0gdmV4LmRpYWxvZy5wcm9tcHQoe1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnVXBkYXRlIE1hcmtlciBOYW1lJyxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGVudHJ5LmRhdGEubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgcGxhY2Vob2xkZXI6ICdMb2NhdGlvbiAnICsgaWR4LFxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjazogKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZih2YWx1ZSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZW50cnkuZGF0YS5uYW1lID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXRsYXMuc2F2ZU1hcmtlcnMod2luZG93Lk1BUF9UQUcsIGF0bGFzLm1hcmtlcnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUodHJ1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNle1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICBtYXJrZXJzVG9TdHJpbmc6IChtYXJrZXJzKSA9PiB7XG4gICAgICAgICAgICBsZXQgb3V0cHV0ID0gJyc7XG4gICAgICAgICAgICBtYXJrZXJzLmZvckVhY2goKGVudHJ5LCBpZHgpID0+IHtcbiAgICAgICAgICAgICAgICBpZihlbnRyeSAhPT0gbnVsbCl7XG4gICAgICAgICAgICAgICAgICAgIGxldCBjb29yZCA9IGVudHJ5LnJlZi5wb3NpdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgbGV0IG5hbWUgPSBlbnRyeS5kYXRhLm5hbWUgfHwgJ0xvY2F0aW9uICcgKyBpZHg7XG4gICAgICAgICAgICAgICAgICAgIG91dHB1dCArPSBjb29yZC5sYXQoKSArICcsJyArIGNvb3JkLmxuZygpICsgJywnICsgbmFtZSArICckJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICAgIH0sXG5cbiAgICAgICAgbWFya2Vyc0Zyb21TdHJpbmc6IChzdHIpID0+IHtcbiAgICAgICAgICAgIHJldHVybiBzdHIuc3BsaXQoJyQnKS5tYXAocGFpciA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGNvb3JkcyA9IHBhaXIuc3BsaXQoJywnKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29vcmRzO1xuICAgICAgICAgICAgfSkuZmlsdGVyKGNvb3JkcyA9PiBjb29yZHMubGVuZ3RoICE9PSAxKS5tYXAoKGNvb3JkcywgaWR4KSA9PntcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgICAgICBsYXQ6IHBhcnNlRmxvYXQoY29vcmRzWzBdKSxcbiAgICAgICAgICAgICAgICAgICAgbG5nOiBwYXJzZUZsb2F0KGNvb3Jkc1sxXSksXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IGNvb3Jkc1syXSB8fCAnTG9jYXRpb24gJyArIGlkeFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIHNhdmVNYXJrZXJzOiAodGFnLCBsaXN0KSA9PiB7XG4gICAgICAgIFx0aWYodGFnKXtcbiAgICAgICAgXHRcdGxvY2FsU3RvcmFnZS5zZXRJdGVtKHRhZywgYXRsYXMubWFya2Vyc1RvU3RyaW5nKGxpc3QpKTtcbiAgICAgICAgXHR9XG4gICAgICAgIH0sXG5cbiAgICAgICAgbG9hZE1hcmtlcnM6ICh0YWcpID0+IHtcbiAgICAgICAgXHRsZXQgc3RyID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0odGFnKTtcbiAgICAgICAgXHRyZXR1cm4gc3RyID8gYXRsYXMubWFya2Vyc0Zyb21TdHJpbmcoc3RyKSA6IGZhbHNlO1xuICAgICAgICB9LFxuXG4gICAgICAgIGxhc3RJbmZvV2luZG93OiBmYWxzZSxcblxuICAgICAgICBhZGREZWZhdWx0TWFya2VyOiAoZGF0YSkgPT4ge1xuXHRcdFx0bGV0IGVudHJ5ID0gYXRsYXMuYWRkTWFya2VyKHtcbiAgICAgICAgXHRcdG1hcDogZGF0YS5tYXAsXG4gICAgICAgICAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgICBcdFx0bGF0OiBkYXRhLmNvb3JkLmxhdCxcbiAgICAgICAgXHRcdGxuZzogZGF0YS5jb29yZC5sbmcsXG4gICAgICAgIFx0XHRldmVudHM6IHtcbiAgICAgICAgXHRcdFx0Y2xpY2s6IChlLCBtLCBpKSA9PiB7XG4gICAgICAgIFx0XHRcdFx0Y29uc29sZS5sb2coJ2NsaWNrJywgaSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihhdGxhcy5pc1NoaWZ0Q2xpY2soKSl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXRsYXMucmVtb3ZlTWFya2VyKGkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgZW50cnkgPSBhdGxhcy5tYXJrZXJzW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpbmZvID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBlbnRyeS5kYXRhLm5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihhdGxhcy5tYXApe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvLm9wZW4oYXRsYXMubWFwLCBlbnRyeS5yZWYpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihhdGxhcy5sYXN0SW5mb1dpbmRvdyl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdGxhcy5sYXN0SW5mb1dpbmRvdy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXRsYXMubGFzdEluZm9XaW5kb3cgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdGxhcy5sYXN0SW5mb1dpbmRvdyA9IGluZm87XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICBcdFx0XHR9LFxuICAgICAgICBcdFx0XHRkYmxjbGljazogKGUsIG0sIGkpID0+IHtcbiAgICAgICAgXHRcdFx0XHRjb25zb2xlLmxvZygnZGJsY2xpY2snLCBpKTtcbiAgICAgICAgXHRcdFx0XHRhdGxhcy51cGRhdGVOYW1lKGkpLnRoZW4odXBkYXRlZCA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYodXBkYXRlZCl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGF0bGFzLmxhc3RJbmZvV2luZG93KXtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0bGFzLmxhc3RJbmZvV2luZG93LmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdGxhcy5sYXN0SW5mb1dpbmRvdyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIFx0XHRcdH1cbiAgICAgICAgXHRcdH1cbiAgICAgICAgXHR9KTtcbiAgICAgICAgICAgIGVudHJ5LnJlZi5zZXRJY29uKHtcbiAgICAgICAgICAgICAgICBwYXRoOiBnb29nbGUubWFwcy5TeW1ib2xQYXRoLkNJUkNMRSxcbiAgICAgICAgICAgICAgICBzY2FsZTogNy41LFxuICAgICAgICAgICAgICAgIGZpbGxDb2xvcjogJyNGMDAnLFxuICAgICAgICAgICAgICAgIGZpbGxPcGFjaXR5OiAwLjUsXG4gICAgICAgICAgICAgICAgc3Ryb2tlV2VpZ2h0OiAwXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybiBlbnRyeTtcbiAgICAgICAgfSxcblxuICAgICAgICBhZGRWaWV3TWFya2VyOiAoZGF0YSkgPT4ge1xuXHRcdFx0bGV0IGVudHJ5ID0gYXRsYXMuYWRkTWFya2VyKHtcbiAgICAgICAgXHRcdG1hcDogZGF0YS5tYXAsXG4gICAgICAgIFx0XHRsYXQ6IGRhdGEuY29vcmQubGF0LFxuICAgICAgICBcdFx0bG5nOiBkYXRhLmNvb3JkLmxuZyxcbiAgICAgICAgXHRcdGV2ZW50czoge1xuICAgICAgICBcdFx0XHRjbGljazogKGUsIG0sIGkpID0+IHtcbiAgICAgICAgXHRcdFx0XHRjb25zb2xlLmxvZygnY2xpY2snLCBpLCBkYXRhKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBlbnRyeSA9IGF0bGFzLm1hcmtlcnNbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZW50cnlEYXRhID0gZW50cnkuZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBsb2NOYW1lID0gZW50cnlEYXRhLm5hbWUgfHwgJ0xvY2F0aW9uICcgKyBpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGxvY0RhdGEgPSBgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgPGgzPiR7bG9jTmFtZX08L2gzPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDx1bD5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxpPlRpbWU6ICR7ZW50cnlEYXRhLnRpbWV9PC9saT5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxpPkluZmVjdGVkOiAke2VudHJ5RGF0YS5pbmZlY3RlZH08L2xpPlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIDwvdWw+XG4gICAgICAgICAgICAgICAgICAgICAgICBgO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGluZm8gPSBuZXcgZ29vZ2xlLm1hcHMuSW5mb1dpbmRvdyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudDogbG9jRGF0YVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihhdGxhcy5tYXApe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm8ub3BlbihhdGxhcy5tYXAsIGVudHJ5LnJlZik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYXRsYXMubGFzdEluZm9XaW5kb3cpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdGxhcy5sYXN0SW5mb1dpbmRvdy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdGxhcy5sYXN0SW5mb1dpbmRvdyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdGxhcy5sYXN0SW5mb1dpbmRvdyA9IGluZm87XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgIFx0XHRcdH1cbiAgICAgICAgXHRcdH1cbiAgICAgICAgXHR9LCB7XG4gICAgICAgIFx0XHRyZWFkT25seTogdHJ1ZVxuICAgICAgICBcdH0pO1xuICAgICAgICBcdGxldCBpY29uID0gZGF0YS5pY29uIHx8IHtcbiAgICAgICAgXHRcdHNjYWxlOiAwXG4gICAgICAgIFx0fTtcbiAgICAgICAgXHRlbnRyeS5yZWYuc2V0SWNvbih7XG4gICAgICAgIFx0XHRwYXRoOiBnb29nbGUubWFwcy5TeW1ib2xQYXRoLkNJUkNMRSxcbiAgICAgICAgXHRcdHNjYWxlOiAoMS4wKSArICg5LjAgKiBpY29uLnNjYWxlKSxcbiAgICAgICAgXHRcdGZpbGxDb2xvcjogJyNGMDAnLFxuICAgICAgICBcdFx0ZmlsbE9wYWNpdHk6IDAuNSxcbiAgICAgICAgXHRcdHN0cm9rZVdlaWdodDogMFxuICAgICAgICBcdH0pO1xuICAgICAgICBcdHJldHVybiBlbnRyeTtcbiAgICAgICAgfSxcblxuICAgICAgICBhZGRDdXN0b21NYXJrZXI6IChkYXRhKSA9PiB7XG4gICAgICAgICAgICBsZXQgZW50cnkgPSBhdGxhcy5hZGRNYXJrZXIoe1xuICAgICAgICAgICAgICAgIG1hcDogZGF0YS5tYXAsXG4gICAgICAgICAgICAgICAgbGF0OiBkYXRhLmNvb3JkLmxhdCxcbiAgICAgICAgICAgICAgICBsbmc6IGRhdGEuY29vcmQubG5nLFxuICAgICAgICAgICAgICAgIGV2ZW50czoge1xuICAgICAgICAgICAgICAgICAgICBjbGljazogKGUsIG0sIGkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjbGljaycsIGksIGRhdGEpO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IGVudHJ5ID0gYXRsYXMubWFya2Vyc1tpXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpbmZvID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGRhdGEudGV4dFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZihhdGxhcy5tYXApe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm8ub3BlbihhdGxhcy5tYXAsIGVudHJ5LnJlZik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYXRsYXMubGFzdEluZm9XaW5kb3cpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdGxhcy5sYXN0SW5mb1dpbmRvdy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdGxhcy5sYXN0SW5mb1dpbmRvdyA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhdGxhcy5sYXN0SW5mb1dpbmRvdyA9IGluZm87XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LCB7XG4gICAgICAgICAgICAgICAgcmVhZE9ubHk6IHRydWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgbGV0IGljb24gPSBkYXRhLmljb24gfHwge1xuICAgICAgICAgICAgICAgIHNpemU6IDAsXG4gICAgICAgICAgICAgICAgY29sb3I6ICdyZ2IoMCwwLDApJyxcbiAgICAgICAgICAgICAgICBvcGFjaXR5OiAxLjBcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBlbnRyeS5yZWYuc2V0SWNvbih7XG4gICAgICAgICAgICAgICAgcGF0aDogZ29vZ2xlLm1hcHMuU3ltYm9sUGF0aC5DSVJDTEUsXG4gICAgICAgICAgICAgICAgc2NhbGU6IGljb24uc2l6ZSxcbiAgICAgICAgICAgICAgICBmaWxsQ29sb3I6IGljb24uY29sb3IsXG4gICAgICAgICAgICAgICAgZmlsbE9wYWNpdHk6IGljb24ub3BhY2l0eSxcbiAgICAgICAgICAgICAgICBzdHJva2VXZWlnaHQ6IDBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGVudHJ5O1xuICAgICAgICB9LFxuXG4gICAgICAgIGxvYWRNYXBGcm9tRGF0YTogKG1hcCwgdmFsdWUpID0+IHtcbiAgICAgICAgICAgIGxldCBpbnB1dCA9IHZhbHVlLnNwbGl0KCckQEAkJykubWFwKGxpbmUgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBsaW5lLnNwbGl0KCckQCQnKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaW5wdXQuZm9yRWFjaChkYXRhID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgbGF0ID0gcGFyc2VGbG9hdChkYXRhWzBdKTtcbiAgICAgICAgICAgICAgICBsZXQgbG5nID0gcGFyc2VGbG9hdChkYXRhWzFdKTtcbiAgICAgICAgICAgICAgICBsZXQgY29sb3IgPSBkYXRhWzJdO1xuICAgICAgICAgICAgICAgIGxldCBzaXplID0gcGFyc2VGbG9hdChkYXRhWzNdKTtcbiAgICAgICAgICAgICAgICBsZXQgb3BhY2l0eSA9IHBhcnNlRmxvYXQoZGF0YVs0XSk7XG4gICAgICAgICAgICAgICAgbGV0IHRleHQgPSBkYXRhWzVdO1xuICAgICAgICAgICAgICAgIGF0bGFzLmFkZEN1c3RvbU1hcmtlcih7XG4gICAgICAgICAgICAgICAgICAgIG1hcDogbWFwLFxuICAgICAgICAgICAgICAgICAgICBjb29yZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGF0OiBsYXQsXG4gICAgICAgICAgICAgICAgICAgICAgICBsbmc6IGxuZ1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBpY29uOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzaXplOiBzaXplLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IGNvbG9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3BhY2l0eTogb3BhY2l0eVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiB0ZXh0XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGxldCBmaXJzdCA9IGF0bGFzLm1hcmtlcnNbMF07XG4gICAgICAgICAgICBpZihmaXJzdCl7XG4gICAgICAgICAgICAgICAgbWFwLnNldENlbnRlcih7XG4gICAgICAgICAgICAgICAgICAgIGxhdDogZmlyc3QuZGF0YS5sYXQsXG4gICAgICAgICAgICAgICAgICAgIGxuZzogZmlyc3QuZGF0YS5sbmdcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcblxuXHRcdC8vIE1hcCBUaGVtZXNcblxuXHRcdHJlbW92ZVRoZW1lTGFiZWxzOiAodGhlbWUpID0+IHtcblx0XHQgICAgbGV0IGVsZW1lbnRUeXBlcyA9IFsnbGFiZWxzJywgJ2xhYmVscy50ZXh0LmZpbGwnLCAnbGFiZWxzLnRleHQuc3Ryb2tlJ107XG5cdFx0ICAgIGVsZW1lbnRUeXBlcy5mb3JFYWNoKGVsVHlwZSA9PiB7XG5cdFx0ICAgICAgICB0aGVtZS5wdXNoKHtcblx0XHQgICAgICAgIFx0ZWxlbWVudFR5cGU6ICdsYWJlbHMnLFxuXHRcdCAgICAgICAgXHRzdHlsZXJzOiBbe1xuXHRcdCAgICAgICAgXHRcdHZpc2liaWxpdHk6ICdvZmYnXG5cdFx0ICAgICAgICBcdH1dXG5cdFx0ICAgICAgICB9KTtcblx0XHQgICAgfSk7XG5cdFx0ICAgIHJldHVybiB0aGVtZTtcblx0XHR9LFxuXG5cdFx0Y2hhbmdlTWFwU3R5bGU6IChtYXAsIG5hbWUsIHN0eWxlcykgPT4ge1xuXHRcdFx0bGV0IHRoZW1lID0gYXRsYXMucmVtb3ZlVGhlbWVMYWJlbHMoc3R5bGVzKTtcblx0XHRcdGxldCBzdHlsZWRNYXBUeXBlID0gbmV3IGdvb2dsZS5tYXBzLlN0eWxlZE1hcFR5cGUodGhlbWUsIHtcblx0XHRcdFx0bWFwOiBtYXAsXG5cdFx0XHRcdG5hbWU6IG5hbWVcblx0XHRcdH0pO1xuXHRcdFx0bWFwLm1hcFR5cGVzLnNldChuYW1lLCBzdHlsZWRNYXBUeXBlKTtcblx0XHRcdG1hcC5zZXRNYXBUeXBlSWQobmFtZSk7XG5cdFx0fSxcblxuXHRcdGdldE1hcFN0eWxlQnlVUkw6ICh1cmwpID0+IHtcblx0XHRcdGNvbnN0IFNOQVpaWV9NQVBTX1VSTCA9ICdodHRwczovL3NuYXp6eW1hcHMuY29tL2V4cGxvcmUuanNvbj9rZXk9NmZiYjBhNzQtZWM2Ny00MzI5LTgzZWUtMTVlZGQ0NzQwYzRiJztcblxuXHRcdFx0bGV0IGdldFBhZ2UgPSAocGFnZSkgPT4ge1xuXHRcdFx0XHRyZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuXHRcdFx0XHRcdCQuZ2V0KFNOQVpaWV9NQVBTX1VSTCwge1xuXHRcdFx0XHRcdFx0cGFnZTogcGFnZVxuXHRcdFx0XHRcdH0sIChyZXMpID0+IHtcblx0XHRcdFx0XHRcdHJlcy5zdHlsZXMuZm9yRWFjaChzdHlsZSA9PiB7XG5cdFx0XHRcdFx0XHRcdGlmKHN0eWxlLnVybCA9PT0gdXJsKXtcblx0XHRcdFx0XHRcdFx0XHRyZXNvbHZlKHN0eWxlKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHRsZXQgbmV4dFBhZ2UgPSByZXMucGFnaW5hdGlvbi5jdXJyZW50UGFnZSArIDE7XG5cdFx0XHRcdFx0XHRpZihuZXh0UGFnZSA+IHJlcy5wYWdpbmF0aW9uLnRvdGFsUGFnZXMpe1xuXHRcdFx0XHRcdFx0XHRyZWplY3QoJ0NvdWxkIG5vdCBmaW5kIHN0eWxlLicpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0ZWxzZXtcblx0XHRcdFx0XHRcdFx0Z2V0UGFnZShuZXh0UGFnZSkudGhlbihyZWNSZXMgPT4ge1xuXHRcdFx0XHRcdFx0XHRcdHJlc29sdmUocmVjUmVzKTtcblx0XHRcdFx0XHRcdFx0fSkuY2F0Y2gocmVqZWN0KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9KS5lcnJvcigoanFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKSA9PiB7XG5cdFx0XHRcdFx0XHRyZWplY3QoZXJyb3JUaHJvd24pO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR9KTtcblx0XHRcdH1cblxuXHRcdFx0cmV0dXJuIGdldFBhZ2UoMSk7XG5cdFx0fSxcblxuXHRcdHNldEhvdEtleTogKHNob3J0Y3V0LCBjYWxsYmFjaykgPT4ge1xuICAgICAgICAgICAgaG90S2V5c1tzaG9ydGN1dF0gPSBjYWxsYmFjaztcbiAgICAgICAgfVxuXHR9XG5cblx0cmV0dXJuIGF0bGFzO1xufSJdfQ==\n"]}