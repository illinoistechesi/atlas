{"version":3,"sources":["view.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length","1","module","config","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","db","firebase","initializeApp","database","params","qs","split","join","tokens","re","exec","decodeURIComponent","document","location","search","atlas","Atlas","init","then","done","mapOptions","zoom","center","google","maps","LatLng","styles","removeThemeLabels","MAP_STYLES","mapElement","getElementById","map","Map","window","mapRef","setMap","mapThemeTag","localStorage","getItem","mapThemeStyle","theme","JSON","parse","changeMapStyle","console","log","shortcutsList","addEventListener","displayList","createElement","innerHTML","vex","dialog","alert","unsafeMessage","outerHTML","ref","once","snap","val","loadMapFromData","message","catch","err","prompt","callback","value","storedMapData","setHotKey","getMapStyleByURL","style","setItem","name","json","tag","dataToStore","_ref","confirm","replace","p","set","handleSavedMapOverwrite","promise","link"],"mappings":"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","file":"../view.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nvar config = {\n\tapiKey: 'AIzaSyA9EYUXVL5WAh6Aam1qXlWyvi3b7HLcZ1U',\n\tauthDomain: 'esigamma.firebaseapp.com',\n\tdatabaseURL: 'https://esigamma.firebaseio.com',\n\tprojectId: 'esigamma',\n\tstorageBucket: 'esigamma.appspot.com',\n\tmessagingSenderId: '73416363603'\n};\nvar ESIFirebase = firebase.initializeApp(config, 'Atlas');\nvar db = ESIFirebase.database();\n\nfunction getQueryParams(qs) {\n\tqs = qs.split('+').join(' ');\n\tvar params = {},\n\t    tokens,\n\t    re = /[?&]?([^=]+)=([^&]*)/g;\n\twhile (tokens = re.exec(qs)) {\n\t\tparams[decodeURIComponent(tokens[1])] = decodeURIComponent(tokens[2]);\n\t}\n\treturn params;\n}\n\nvar fillText = function fillText(tag, text) {\n\tvar spans = document.getElementsByClassName(tag);\n\tfor (var s = 0; s < spans.length; s++) {\n\t\tvar span = spans[s];\n\t\tspan.innerText = text;\n\t}\n};\n\nvar params = getQueryParams(document.location.search);\n\nvar atlas = Atlas();\n\natlas.init().then(function (done) {\n\n\tvar mapOptions = {\n\t\tzoom: 15,\n\t\tcenter: new google.maps.LatLng(41.259716, -95.960588),\n\t\tstyles: atlas.removeThemeLabels(MAP_STYLES)\n\t};\n\n\tvar mapElement = document.getElementById('map');\n\n\tvar map = new google.maps.Map(mapElement, mapOptions);\n\twindow.mapRef = map;\n\tatlas.setMap(map);\n\n\ttry {\n\t\tvar mapThemeTag = localStorage.getItem('map-theme-tag');\n\t\tvar mapThemeStyle = localStorage.getItem('map-theme-style');\n\t\tif (mapThemeTag && mapThemeStyle) {\n\t\t\tvar theme = JSON.parse(mapThemeStyle);\n\t\t\tatlas.changeMapStyle(map, mapThemeTag, theme);\n\t\t}\n\t} catch (e) {\n\t\tconsole.log(e);\n\t}\n\n\tvar shortcutsList = document.getElementById('shortcuts-list');\n\tdocument.getElementById('shortcuts').addEventListener('click', function (e) {\n\t\tvar displayList = document.createElement('div');\n\t\tdisplayList.innerHTML = shortcutsList.innerHTML;\n\t\tvex.dialog.alert({\n\t\t\tunsafeMessage: displayList.outerHTML\n\t\t});\n\t});\n\n\tif (params.code) {\n\t\tvar ref = db.ref('atlas/saved/' + params.code);\n\t\tref.once('value', function (snap) {\n\t\t\tvar val = snap.val();\n\t\t\tif (val) {\n\t\t\t\tatlas.loadMapFromData(map, val);\n\t\t\t\tvex.dialog.alert({\n\t\t\t\t\tmessage: 'Loaded map data saved at code: ' + params.code + '.'\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tvex.dialog.alert({\n\t\t\t\t\tmessage: 'No map data saved with code: ' + params.code + '.'\n\t\t\t\t});\n\t\t\t}\n\t\t}).catch(function (err) {\n\t\t\tvex.dialog.alert({\n\t\t\t\tmessage: 'Something went wrong with the code: ' + params.code + ', : ' + err + '.'\n\t\t\t});\n\t\t});\n\t} else {\n\t\tvex.dialog.prompt({\n\t\t\tmessage: 'Enter map data:',\n\t\t\tcallback: function callback(value) {\n\t\t\t\tif (value) {\n\t\t\t\t\twindow.storedMapData = value;\n\t\t\t\t\tatlas.loadMapFromData(map, value);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tatlas.setHotKey('t', function (e) {\n\t\tvex.dialog.prompt({\n\t\t\tmessage: 'Enter map theme URL:',\n\t\t\tcallback: function callback(value) {\n\t\t\t\tatlas.getMapStyleByURL(value).then(function (style) {\n\t\t\t\t\tlocalStorage.setItem('map-theme-tag', style.name);\n\t\t\t\t\tlocalStorage.setItem('map-theme-style', style.json);\n\t\t\t\t\tvar tag = style.name;\n\t\t\t\t\tvar theme = JSON.parse(style.json);\n\t\t\t\t\tatlas.changeMapStyle(map, tag, theme);\n\t\t\t\t\tvex.dialog.alert('Changed map theme to: ' + tag);\n\t\t\t\t}).catch(function (err) {\n\t\t\t\t\tvex.dialog.alert('Error: ' + err);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t});\n\n\tatlas.setHotKey('m', function (e) {\n\t\tvex.dialog.prompt({\n\t\t\tmessage: 'Enter map theme data:',\n\t\t\tcallback: function callback(value) {\n\t\t\t\tvar style = {\n\t\t\t\t\tname: 'Custom Style',\n\t\t\t\t\tjson: value\n\t\t\t\t};\n\t\t\t\tlocalStorage.setItem('map-theme-tag', style.name);\n\t\t\t\tlocalStorage.setItem('map-theme-style', style.json);\n\t\t\t\tvar tag = style.name;\n\t\t\t\tvar theme = JSON.parse(style.json);\n\t\t\t\tatlas.changeMapStyle(map, tag, theme);\n\t\t\t\tvex.dialog.alert('Changed map theme to: ' + tag);\n\t\t\t}\n\t\t});\n\t});\n\n\tatlas.setHotKey('l', function (e) {\n\t\tvex.dialog.prompt({\n\t\t\tmessage: 'Enter map data:',\n\t\t\tcallback: function callback(value) {\n\t\t\t\tif (value) {\n\t\t\t\t\twindow.storedMapData = value;\n\t\t\t\t\tatlas.loadMapFromData(map, value);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n\n\tatlas.setHotKey('s', function (e) {\n\t\tvar dataToStore = window.storedMapData;\n\t\tif (dataToStore) {\n\t\t\tvex.dialog.prompt({\n\t\t\t\tmessage: 'Choose a code to save your map with.',\n\t\t\t\tcallback: function callback(code) {\n\t\t\t\t\tif (code) {\n\t\t\t\t\t\tvar _ref = db.ref('atlas/saved/' + code);\n\t\t\t\t\t\t_ref.once('value', function (snap) {\n\t\t\t\t\t\t\tvar val = snap.val();\n\t\t\t\t\t\t\tif (val) {\n\t\t\t\t\t\t\t\tvex.dialog.confirm({\n\t\t\t\t\t\t\t\t\tmessage: 'There is already a map saved with code: ' + code + '. Do you want to replace it?',\n\t\t\t\t\t\t\t\t\tcallback: function callback(replace) {\n\t\t\t\t\t\t\t\t\t\tif (replace) {\n\t\t\t\t\t\t\t\t\t\t\tvar p = _ref.set(dataToStore);\n\t\t\t\t\t\t\t\t\t\t\thandleSavedMapOverwrite(p, code);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvar p = _ref.set(dataToStore);\n\t\t\t\t\t\t\t\thandleSavedMapOverwrite(p, code);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tvex.dialog.alert('There is no map data to save.');\n\t\t}\n\t});\n\n\tvar handleSavedMapOverwrite = function handleSavedMapOverwrite(promise, code) {\n\t\tpromise.then(function (done) {\n\t\t\tvar link = 'illinoistechesi.github.io/atlas/view?code=' + code;\n\t\t\tvex.dialog.prompt({\n\t\t\t\tmessage: 'Share your map with this link:',\n\t\t\t\tvalue: link,\n\t\t\t\tcallback: function callback() {}\n\t\t\t});\n\t\t}).catch(function (err) {\n\t\t\tvex.dialog.alert('Something went wrong: ' + err + '.');\n\t\t});\n\t};\n\n\t/*atlas.setHotKey('u', e => {\n \tvex.dialog.prompt({\n \t\tmessage: 'Enter hosted data file URL:',\n \t\tcallback: (value) => {\n \t\t\t$.get(value).then(res => {\n \t\t\t\tconsole.log(res);\n \t\t\t}).catch(err => {\n \t\t\t\tconsole.error(err);\n \t\t\t});\n \t\t\t//atlas.loadMapFromDataFile()\n \t\t}\n \t});\n });*/\n});\n\n},{}]},{},[1])\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvdmlldy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDQUEsSUFBSSxTQUFTO0FBQ1osU0FBUSx5Q0FESTtBQUVaLGFBQVksMEJBRkE7QUFHWixjQUFhLGlDQUhEO0FBSVosWUFBVyxVQUpDO0FBS1osZ0JBQWUsc0JBTEg7QUFNWixvQkFBbUI7QUFOUCxDQUFiO0FBUUEsSUFBSSxjQUFjLFNBQVMsYUFBVCxDQUF1QixNQUF2QixFQUErQixPQUEvQixDQUFsQjtBQUNBLElBQUksS0FBSyxZQUFZLFFBQVosRUFBVDs7QUFFQSxTQUFTLGNBQVQsQ0FBd0IsRUFBeEIsRUFBNEI7QUFDM0IsTUFBSyxHQUFHLEtBQUgsQ0FBUyxHQUFULEVBQWMsSUFBZCxDQUFtQixHQUFuQixDQUFMO0FBQ0EsS0FBSSxTQUFTLEVBQWI7QUFBQSxLQUNDLE1BREQ7QUFBQSxLQUVDLEtBQUssdUJBRk47QUFHQSxRQUFPLFNBQVMsR0FBRyxJQUFILENBQVEsRUFBUixDQUFoQixFQUE2QjtBQUM1QixTQUFPLG1CQUFtQixPQUFPLENBQVAsQ0FBbkIsQ0FBUCxJQUF3QyxtQkFBbUIsT0FBTyxDQUFQLENBQW5CLENBQXhDO0FBQ0E7QUFDRCxRQUFPLE1BQVA7QUFDQTs7QUFFRCxJQUFJLFdBQVcsU0FBWCxRQUFXLENBQUMsR0FBRCxFQUFNLElBQU4sRUFBZTtBQUM3QixLQUFJLFFBQVEsU0FBUyxzQkFBVCxDQUFnQyxHQUFoQyxDQUFaO0FBQ0EsTUFBSSxJQUFJLElBQUksQ0FBWixFQUFlLElBQUksTUFBTSxNQUF6QixFQUFpQyxHQUFqQyxFQUFxQztBQUNwQyxNQUFJLE9BQU8sTUFBTSxDQUFOLENBQVg7QUFDQSxPQUFLLFNBQUwsR0FBaUIsSUFBakI7QUFDQTtBQUNELENBTkQ7O0FBUUEsSUFBSSxTQUFTLGVBQWUsU0FBUyxRQUFULENBQWtCLE1BQWpDLENBQWI7O0FBRUEsSUFBSSxR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YSxnQkFBUTtBQUNwQixPQUFJLHNEQUFvRCxJQUF4RDtBQUNBLE9BQUksTUFBSixDQUFXLE1BQVgsQ0FBa0I7QUFDakIsNkNBRGlCO0FBRWpCLFdBQU8sSUFGVTtBQUdqQixjQUFVLG9CQUFNLENBQUU7QUFIRCxJQUFsQjtBQUtBLEdBUEQsRUFPRyxLQVBILENBT1MsZUFBTztBQUNmLE9BQUksTUFBSixDQUFXLEtBQVgsNEJBQTBDLEdBQTFDO0FBQ0EsR0FURDtBQVVBLEVBWEQ7O0FBYUE7Ozs7Ozs7Ozs7Ozs7QUFjQSxDQWxMRCIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJsZXQgY29uZmlnID0ge1xuXHRhcGlLZXk6ICdBSXphU3lBOUVZVVhWTDVXQWg2QWFtMXFYbFd5dmkzYjdITGNaMVUnLFxuXHRhdXRoRG9tYWluOiAnZXNpZ2FtbWEuZmlyZWJhc2VhcHAuY29tJyxcblx0ZGF0YWJhc2VVUkw6ICdodHRwczovL2VzaWdhbW1hLmZpcmViYXNlaW8uY29tJyxcblx0cHJvamVjdElkOiAnZXNpZ2FtbWEnLFxuXHRzdG9yYWdlQnVja2V0OiAnZXNpZ2FtbWEuYXBwc3BvdC5jb20nLFxuXHRtZXNzYWdpbmdTZW5kZXJJZDogJzczNDE2MzYzNjAzJ1xufTtcbmxldCBFU0lGaXJlYmFzZSA9IGZpcmViYXNlLmluaXRpYWxpemVBcHAoY29uZmlnLCAnQXRsYXMnKTtcbmxldCBkYiA9IEVTSUZpcmViYXNlLmRhdGFiYXNlKCk7XG5cbmZ1bmN0aW9uIGdldFF1ZXJ5UGFyYW1zKHFzKSB7XG5cdHFzID0gcXMuc3BsaXQoJysnKS5qb2luKCcgJyk7XG5cdHZhciBwYXJhbXMgPSB7fSxcblx0XHR0b2tlbnMsXG5cdFx0cmUgPSAvWz8mXT8oW149XSspPShbXiZdKikvZztcblx0d2hpbGUgKHRva2VucyA9IHJlLmV4ZWMocXMpKSB7XG5cdFx0cGFyYW1zW2RlY29kZVVSSUNvbXBvbmVudCh0b2tlbnNbMV0pXSA9IGRlY29kZVVSSUNvbXBvbmVudCh0b2tlbnNbMl0pO1xuXHR9XG5cdHJldHVybiBwYXJhbXM7XG59XG5cbmxldCBmaWxsVGV4dCA9ICh0YWcsIHRleHQpID0+IHtcblx0bGV0IHNwYW5zID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSh0YWcpO1xuXHRmb3IobGV0IHMgPSAwOyBzIDwgc3BhbnMubGVuZ3RoOyBzKyspe1xuXHRcdGxldCBzcGFuID0gc3BhbnNbc107XG5cdFx0c3Bhbi5pbm5lclRleHQgPSB0ZXh0O1xuXHR9XG59XG5cbmxldCBwYXJhbXMgPSBnZXRRdWVyeVBhcmFtcyhkb2N1bWVudC5sb2NhdGlvbi5zZWFyY2gpO1xuXG5sZXQgYXRsYXMgPSBBdGxhcygpO1xuXG5hdGxhcy5pbml0KCkudGhlbihkb25lID0+IHtcblxuXHRsZXQgbWFwT3B0aW9ucyA9IHtcblx0ICAgIHpvb206IDE1LFxuXHQgICAgY2VudGVyOiBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKDQxLjI1OTcxNiwgLTk1Ljk2MDU4OCksXG5cdCAgICBzdHlsZXM6IGF0bGFzLnJlbW92ZVRoZW1lTGFiZWxzKE1BUF9TVFlMRVMpXG5cdH07XG5cblx0bGV0IG1hcEVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbWFwJyk7XG5cblx0bGV0IG1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAobWFwRWxlbWVudCwgbWFwT3B0aW9ucyk7XG5cdHdpbmRvdy5tYXBSZWYgPSBtYXA7XG5cdGF0bGFzLnNldE1hcChtYXApO1xuXG5cdHRyeXtcblx0XHRsZXQgbWFwVGhlbWVUYWcgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnbWFwLXRoZW1lLXRhZycpO1xuXHRcdGxldCBtYXBUaGVtZVN0eWxlID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ21hcC10aGVtZS1zdHlsZScpO1xuXHRcdGlmKG1hcFRoZW1lVGFnICYmIG1hcFRoZW1lU3R5bGUpe1xuXHRcdFx0bGV0IHRoZW1lID0gSlNPTi5wYXJzZShtYXBUaGVtZVN0eWxlKTtcblx0XHRcdGF0bGFzLmNoYW5nZU1hcFN0eWxlKG1hcCwgbWFwVGhlbWVUYWcsIHRoZW1lKTtcblx0XHR9XG5cdH1cblx0Y2F0Y2goZSl7XG5cdFx0Y29uc29sZS5sb2coZSk7XG5cdH1cblxuICAgIGxldCBzaG9ydGN1dHNMaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3J0Y3V0cy1saXN0Jyk7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3Nob3J0Y3V0cycpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZSA9PiB7XG4gICAgICAgIGxldCBkaXNwbGF5TGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgZGlzcGxheUxpc3QuaW5uZXJIVE1MID0gc2hvcnRjdXRzTGlzdC5pbm5lckhUTUw7XG4gICAgICAgIHZleC5kaWFsb2cuYWxlcnQoe1xuICAgICAgICAgICAgdW5zYWZlTWVzc2FnZTogZGlzcGxheUxpc3Qub3V0ZXJIVE1MXG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaWYocGFyYW1zLmNvZGUpe1xuICAgIFx0bGV0IHJlZiA9IGRiLnJlZignYXRsYXMvc2F2ZWQvJyArIHBhcmFtcy5jb2RlKTtcbiAgICBcdHJlZi5vbmNlKCd2YWx1ZScsIHNuYXAgPT4ge1xuICAgIFx0XHRsZXQgdmFsID0gc25hcC52YWwoKTtcbiAgICBcdFx0aWYodmFsKXtcbiAgICBcdFx0XHRhdGxhcy5sb2FkTWFwRnJvbURhdGEobWFwLCB2YWwpO1xuICAgIFx0XHRcdHZleC5kaWFsb2cuYWxlcnQoe1xuXHQgICAgXHRcdFx0bWVzc2FnZTogYExvYWRlZCBtYXAgZGF0YSBzYXZlZCBhdCBjb2RlOiAke3BhcmFtcy5jb2RlfS5gXG5cdCAgICBcdFx0fSk7XG4gICAgXHRcdH1cbiAgICBcdFx0ZWxzZXtcbiAgICBcdFx0XHR2ZXguZGlhbG9nLmFsZXJ0KHtcblx0ICAgIFx0XHRcdG1lc3NhZ2U6IGBObyBtYXAgZGF0YSBzYXZlZCB3aXRoIGNvZGU6ICR7cGFyYW1zLmNvZGV9LmBcblx0ICAgIFx0XHR9KTtcbiAgICBcdFx0fVxuICAgIFx0fSkuY2F0Y2goZXJyID0+IHtcbiAgICBcdFx0dmV4LmRpYWxvZy5hbGVydCh7XG4gICAgXHRcdFx0bWVzc2FnZTogYFNvbWV0aGluZyB3ZW50IHdyb25nIHdpdGggdGhlIGNvZGU6ICR7cGFyYW1zLmNvZGV9LCA6ICR7ZXJyfS5gXG4gICAgXHRcdH0pO1xuICAgIFx0fSk7XG4gICAgfVxuICAgIGVsc2V7XG5cdFx0dmV4LmRpYWxvZy5wcm9tcHQoe1xuXHRcdFx0bWVzc2FnZTogJ0VudGVyIG1hcCBkYXRhOicsXG5cdFx0XHRjYWxsYmFjazogKHZhbHVlKSA9PiB7XG5cdFx0XHRcdGlmKHZhbHVlKXtcblx0XHRcdFx0XHR3aW5kb3cuc3RvcmVkTWFwRGF0YSA9IHZhbHVlO1xuXHRcdFx0XHRcdGF0bGFzLmxvYWRNYXBGcm9tRGF0YShtYXAsIHZhbHVlKTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH0pO1xuICAgIH1cblxuXHRhdGxhcy5zZXRIb3RLZXkoJ3QnLCBlID0+IHtcblx0XHR2ZXguZGlhbG9nLnByb21wdCh7XG5cdFx0XHRtZXNzYWdlOiAnRW50ZXIgbWFwIHRoZW1lIFVSTDonLFxuXHRcdFx0Y2FsbGJhY2s6ICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRhdGxhcy5nZXRNYXBTdHlsZUJ5VVJMKHZhbHVlKS50aGVuKHN0eWxlID0+IHtcblx0XHRcdFx0XHRsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnbWFwLXRoZW1lLXRhZycsIHN0eWxlLm5hbWUpO1xuXHRcdFx0XHRcdGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdtYXAtdGhlbWUtc3R5bGUnLCBzdHlsZS5qc29uKTtcblx0XHRcdFx0XHRsZXQgdGFnID0gc3R5bGUubmFtZTtcblx0XHRcdFx0XHRsZXQgdGhlbWUgPSBKU09OLnBhcnNlKHN0eWxlLmpzb24pO1xuXHRcdFx0XHRcdGF0bGFzLmNoYW5nZU1hcFN0eWxlKG1hcCwgdGFnLCB0aGVtZSk7XG5cdFx0XHRcdFx0dmV4LmRpYWxvZy5hbGVydCgnQ2hhbmdlZCBtYXAgdGhlbWUgdG86ICcgKyB0YWcpO1xuXHRcdFx0XHR9KS5jYXRjaChlcnIgPT4ge1xuXHRcdFx0XHRcdHZleC5kaWFsb2cuYWxlcnQoJ0Vycm9yOiAnICsgZXJyKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0pO1xuXG5cdGF0bGFzLnNldEhvdEtleSgnbScsIGUgPT4ge1xuXHRcdHZleC5kaWFsb2cucHJvbXB0KHtcblx0XHRcdG1lc3NhZ2U6ICdFbnRlciBtYXAgdGhlbWUgZGF0YTonLFxuXHRcdFx0Y2FsbGJhY2s6ICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRsZXQgc3R5bGUgPSB7XG5cdFx0XHRcdFx0bmFtZTogJ0N1c3RvbSBTdHlsZScsXG5cdFx0XHRcdFx0anNvbjogdmFsdWVcblx0XHRcdFx0fVxuXHRcdFx0XHRsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnbWFwLXRoZW1lLXRhZycsIHN0eWxlLm5hbWUpO1xuXHRcdFx0XHRsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnbWFwLXRoZW1lLXN0eWxlJywgc3R5bGUuanNvbik7XG5cdFx0XHRcdGxldCB0YWcgPSBzdHlsZS5uYW1lO1xuXHRcdFx0XHRsZXQgdGhlbWUgPSBKU09OLnBhcnNlKHN0eWxlLmpzb24pO1xuXHRcdFx0XHRhdGxhcy5jaGFuZ2VNYXBTdHlsZShtYXAsIHRhZywgdGhlbWUpO1xuXHRcdFx0XHR2ZXguZGlhbG9nLmFsZXJ0KCdDaGFuZ2VkIG1hcCB0aGVtZSB0bzogJyArIHRhZyk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0pO1xuXG5cdGF0bGFzLnNldEhvdEtleSgnbCcsIGUgPT4ge1xuXHRcdHZleC5kaWFsb2cucHJvbXB0KHtcblx0XHRcdG1lc3NhZ2U6ICdFbnRlciBtYXAgZGF0YTonLFxuXHRcdFx0Y2FsbGJhY2s6ICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRpZih2YWx1ZSl7XG5cdFx0XHRcdFx0d2luZG93LnN0b3JlZE1hcERhdGEgPSB2YWx1ZTtcblx0XHRcdFx0XHRhdGxhcy5sb2FkTWFwRnJvbURhdGEobWFwLCB2YWx1ZSk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblx0fSk7XG5cblx0YXRsYXMuc2V0SG90S2V5KCdzJywgZSA9PiB7XG5cdFx0bGV0IGRhdGFUb1N0b3JlID0gd2luZG93LnN0b3JlZE1hcERhdGE7XG5cdFx0aWYoZGF0YVRvU3RvcmUpe1xuXHRcdFx0dmV4LmRpYWxvZy5wcm9tcHQoe1xuXHRcdFx0XHRtZXNzYWdlOiAnQ2hvb3NlIGEgY29kZSB0byBzYXZlIHlvdXIgbWFwIHdpdGguJyxcblx0XHRcdFx0Y2FsbGJhY2s6IChjb2RlKSA9PiB7XG5cdFx0XHRcdFx0aWYoY29kZSl7XG5cdFx0XHRcdFx0XHRsZXQgcmVmID0gZGIucmVmKCdhdGxhcy9zYXZlZC8nICsgY29kZSk7XG5cdFx0XHRcdFx0XHRyZWYub25jZSgndmFsdWUnLCBzbmFwID0+IHtcblx0XHRcdFx0XHRcdFx0bGV0IHZhbCA9IHNuYXAudmFsKCk7XG5cdFx0XHRcdFx0XHRcdGlmKHZhbCl7XG5cdFx0XHRcdFx0XHRcdFx0dmV4LmRpYWxvZy5jb25maXJtKHtcblx0XHRcdFx0XHRcdFx0XHRcdG1lc3NhZ2U6IGBUaGVyZSBpcyBhbHJlYWR5IGEgbWFwIHNhdmVkIHdpdGggY29kZTogJHtjb2RlfS4gRG8geW91IHdhbnQgdG8gcmVwbGFjZSBpdD9gLFxuXHRcdFx0XHRcdFx0XHRcdFx0Y2FsbGJhY2s6IChyZXBsYWNlKSA9PiB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmKHJlcGxhY2Upe1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGxldCBwID0gcmVmLnNldChkYXRhVG9TdG9yZSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aGFuZGxlU2F2ZWRNYXBPdmVyd3JpdGUocCwgY29kZSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRlbHNle1xuXHRcdFx0XHRcdFx0XHRcdGxldCBwID0gcmVmLnNldChkYXRhVG9TdG9yZSk7XG5cdFx0XHRcdFx0XHRcdFx0aGFuZGxlU2F2ZWRNYXBPdmVyd3JpdGUocCwgY29kZSk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdGVsc2V7XG5cdFx0XHR2ZXguZGlhbG9nLmFsZXJ0KCdUaGVyZSBpcyBubyBtYXAgZGF0YSB0byBzYXZlLicpO1xuXHRcdH1cblx0fSk7XG5cblx0bGV0IGhhbmRsZVNhdmVkTWFwT3ZlcndyaXRlID0gKHByb21pc2UsIGNvZGUpID0+IHtcblx0XHRwcm9taXNlLnRoZW4oZG9uZSA9PiB7XG5cdFx0XHRsZXQgbGluayA9IGBpbGxpbm9pc3RlY2hlc2kuZ2l0aHViLmlvL2F0bGFzL3ZpZXc/Y29kZT0ke2NvZGV9YDtcblx0XHRcdHZleC5kaWFsb2cucHJvbXB0KHtcblx0XHRcdFx0bWVzc2FnZTogYFNoYXJlIHlvdXIgbWFwIHdpdGggdGhpcyBsaW5rOmAsXG5cdFx0XHRcdHZhbHVlOiBsaW5rLFxuXHRcdFx0XHRjYWxsYmFjazogKCkgPT4ge31cblx0XHRcdH0pO1xuXHRcdH0pLmNhdGNoKGVyciA9PiB7XG5cdFx0XHR2ZXguZGlhbG9nLmFsZXJ0KGBTb21ldGhpbmcgd2VudCB3cm9uZzogJHtlcnJ9LmApO1xuXHRcdH0pO1xuXHR9XG5cblx0LyphdGxhcy5zZXRIb3RLZXkoJ3UnLCBlID0+IHtcblx0XHR2ZXguZGlhbG9nLnByb21wdCh7XG5cdFx0XHRtZXNzYWdlOiAnRW50ZXIgaG9zdGVkIGRhdGEgZmlsZSBVUkw6Jyxcblx0XHRcdGNhbGxiYWNrOiAodmFsdWUpID0+IHtcblx0XHRcdFx0JC5nZXQodmFsdWUpLnRoZW4ocmVzID0+IHtcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhyZXMpO1xuXHRcdFx0XHR9KS5jYXRjaChlcnIgPT4ge1xuXHRcdFx0XHRcdGNvbnNvbGUuZXJyb3IoZXJyKTtcblx0XHRcdFx0fSk7XG5cdFx0XHRcdC8vYXRsYXMubG9hZE1hcEZyb21EYXRhRmlsZSgpXG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0pOyovXG5cbn0pOyJdfQ==\n"]}